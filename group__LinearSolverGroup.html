<!-- HTML header for doxygen 1.8.10-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=9"/>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="author" content="SXS Collaboration">
    <meta name="generator" content="Doxygen 1.8.13"/>
    <style>
        /*!
         * IE10 viewport hack for Surface/desktop Windows 8 bug
         * Copyright 2014-2015 Twitter, Inc.
         * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
         */
        @-webkit-viewport { width: device-width; }
        @-moz-viewport    { width: device-width; }
        @-ms-viewport     { width: device-width; }
        @-o-viewport      { width: device-width; }
        @viewport         { width: device-width; }
      </style>
  <title>SpECTRE: Linear Solver</title>
  <link href="tabs.css" rel="stylesheet" type="text/css"/>
  <script type="text/javascript" src="jquery.js"></script>
  <script type="text/javascript" src="dynsections.js"></script>
  <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
  <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js", "color.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
MathJax.Hub.Config({
    TeX: { equationNumbers: { autoNumber: "AMS" } }
});
MathJax.Hub.Config({
    tex2jax: {inlineMath: [['^^','^^'], ['\\(', '\\)']]}
});
</script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js"></script>
  <link href="octicons.css" rel="stylesheet">
  <link href="bootstrap.min.css" rel="stylesheet">
  <link href="doxygen.css" rel="stylesheet" type="text/css" />
  <script type="text/javascript" src="jquery.js"></script>
  <script type="text/javascript" src="popper.min.js"></script>
  <script type="text/javascript" src="bootstrap.min.js"></script>
  <script type="text/javascript" src="spectre.js"></script>
  </head>
  <body>
  <div id="top" class="navbar-fixed-top"><!-- do not remove this div, it is closed by doxygen! -->
  <!-- BEGIN TITLEAREA -->
  <div id="titlearea">
  <script type="text/javascript">
  var searchBox = new SearchBox("searchBox", "search",false,'Search');
  </script>
  <div id="main-nav">
    <ul class="sm sm-dox" id="main-menu">
      <li>
      <a href="index.html">
      SpECTRE &#160;
        <span id="projectnumber">v0.0.0</span>
      </a>
      </li>
      <li class="dropdown">
        <a class="dropdown-toggle" data-toggle="dropdown" href="#" id="selected">
          <span id="selected">
            <i class="octicon octicon-book"></i><span>Documentation</span>
          </span>
          <span class="caret"></span>
        </a>
        <ul class="dropdown-menu">
          <li style="min-width: 135px;">
            <a href="index.html">
            <i class="octicon octicon-book"></i><span>Introduction</span></a>
          </li>
          <li style="min-width: 135px;">
            <a href="installation.html">
              <i class="octicon octicon-desktop-download"></i><span>Installation</span>
            </a>
          </li>
          <li style="min-width: 135px;">
            <a href="tutorials.html">
              <i class="octicon octicon-mortar-board"></i><span>User Tutorials</span>
            </a>
          </li>
          <li style="min-width: 135px;">
            <a href="dev_guide.html">
              <i class="octicon octicon-gist-secret"></i><span>Dev Guide</span>
            </a>
          </li>
          <li style="min-width: 135px;">
            <a href="code_of_conduct.html">
              <i class="octicon octicon-comment-discussion"></i><span>Code of Conduct</span>
            </a>
          </li>
          <li style="min-width: 135px;">
            <a href="contributing_to_spectre.html">
              <i class="octicon octicon-git-pull-request"></i><span>Contributing Guide</span>
            </a>
          </li>
        </ul>
      </li>
      <li class="dropdown">
        <a class="dropdown-toggle" data-toggle="dropdown" href="#" id="selected">
          <span id="selected">
            <i class="octicon octicon-code"></i>
              <span>Code Reference</span>
          </span>
          <span class="caret"></span>
        </a>
        <ul class="dropdown-menu">
          <li style="min-width: 130px;">
            <a href="modules.html">
              <i class="octicon octicon-code"></i>
              <span>Topics</span>
            </a>
          </li>
          <li style="min-width: 130px;">
            <a href="namespaces.html">
              <i class="octicon octicon-gist"></i>
              <span>Namespaces</span>
            </a>
          </li>
        </ul>
      </li>
      <li>
        <a href="files.html">
          <i class="octicon octicon-file-directory"></i><span>Files</span>
        </a>
      </li>
      <li>
        <a href="citelist.html">
          <i class="octicon octicon-file-text"></i><span>Bibliography</span>
        </a>
      </li>
      <li>
        <a href="https://github.com/sxs-collaboration/spectre" target="_blank">
          <i class="octicon octicon-mark-github"></i><span>View on GitHub</span>
        </a>
      </li>
      <!--The Search <li> is added by doxygen later-->
    </ul>
  </div><!-- main-nav -->
  </div><!-- titlearea -->
  <!-- window showing the filter options -->
  <div id="MSearchSelectWindow"  style="position: fixed;"
       onmouseover="return searchBox.OnSearchSelectShow()"
       onmouseout="return searchBox.OnSearchSelectHide()"
       onkeydown="return searchBox.OnSearchSelectKey(event)">
  </div>
  <!-- iframe showing the search results (closed by default) -->
  <div id="MSearchResultsWindow"  style="position: fixed;">
  <iframe src="javascript:void(0)" frameborder="0"
          name="MSearchResults" id="MSearchResults">
  </iframe>
  </div>
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#namespaces">Namespaces</a> &#124;
<a href="#nested-classes">Classes</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">Linear Solver</div>  </div>
</div><!--header-->
<div class="contents">

<p>Algorithms to solve linear systems of equations.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="namespaces"></a>
Namespaces</h2></td></tr>
<tr class="memitem:namespaceLinearSolver_1_1InnerProductImpls"><td class="memItemLeft" align="right" valign="top"> &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceLinearSolver_1_1InnerProductImpls.html">LinearSolver::InnerProductImpls</a></td></tr>
<tr class="memdesc:namespaceLinearSolver_1_1InnerProductImpls"><td class="mdescLeft">&#160;</td><td class="mdescRight">Implementations of <a class="el" href="group__LinearSolverGroup.html#ga9f4f80fb21f848e2fac02bebe6c1d1e0" title="The local part of the Euclidean inner product on the vector space w.r.t. which the addition and scala...">LinearSolver::inner_product</a>. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:namespaceLinearSolver"><td class="memItemLeft" align="right" valign="top"> &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceLinearSolver.html">LinearSolver</a></td></tr>
<tr class="memdesc:namespaceLinearSolver"><td class="mdescLeft">&#160;</td><td class="mdescRight">Functionality for solving linear systems of equations. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:namespaceLinearSolver_1_1Tags"><td class="memItemLeft" align="right" valign="top"> &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceLinearSolver_1_1Tags.html">LinearSolver::Tags</a></td></tr>
<tr class="memdesc:namespaceLinearSolver_1_1Tags"><td class="mdescLeft">&#160;</td><td class="mdescRight">The <a class="el" href="group__DataBoxGroup.html">DataBox</a> tags associated with the linear solver. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:namespaceLinearSolver_1_1OptionTags"><td class="memItemLeft" align="right" valign="top"> &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceLinearSolver_1_1OptionTags.html">LinearSolver::OptionTags</a></td></tr>
<tr class="memdesc:namespaceLinearSolver_1_1OptionTags"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="classOption.html" title="The type that options are passed around as. Contains YAML node data and an OptionContext. ">Option</a> tags related to the iterative linear solver. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structLinearSolver_1_1ConjugateGradient.html">LinearSolver::ConjugateGradient&lt; Metavariables, FieldsTag &gt;</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">A conjugate gradient solver for linear systems of equations \(Ax=b\) where the operator \(A\) is symmetric.  <a href="structLinearSolver_1_1ConjugateGradient.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structLinearSolver_1_1Gmres.html">LinearSolver::Gmres&lt; Metavariables, FieldsTag &gt;</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">A GMRES solver for nonsymmetric linear systems of equations \(Ax=b\).  <a href="structLinearSolver_1_1Gmres.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga9f4f80fb21f848e2fac02bebe6c1d1e0"><td class="memTemplParams" colspan="2">template&lt;typename Lhs , typename Rhs &gt; </td></tr>
<tr class="memitem:ga9f4f80fb21f848e2fac02bebe6c1d1e0"><td class="memTemplItemLeft" align="right" valign="top">double&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__LinearSolverGroup.html#ga9f4f80fb21f848e2fac02bebe6c1d1e0">LinearSolver::inner_product</a> (const Lhs &amp;lhs, const Rhs &amp;rhs) noexcept</td></tr>
<tr class="memdesc:ga9f4f80fb21f848e2fac02bebe6c1d1e0"><td class="mdescLeft">&#160;</td><td class="mdescRight">The local part of the Euclidean inner product on the vector space w.r.t. which the addition and scalar multiplication of both <code>Lhs</code> and <code>Rhs</code> is defined.  <a href="group__LinearSolverGroup.html#ga9f4f80fb21f848e2fac02bebe6c1d1e0">More...</a><br /></td></tr>
<tr class="separator:ga9f4f80fb21f848e2fac02bebe6c1d1e0"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>Algorithms to solve linear systems of equations. </p>
<h3>Details</h3>
<p>In a way, the linear solver is for elliptic systems what time stepping is for the evolution code. This is because the DG scheme for an elliptic system reduces to a linear system of equations of the type \(Ax=b\), where \(A\) is a global matrix representing the DG discretization of the problem. Since this is one equation for each node in the computational domain it becomes unfeasible to numerically invert the global matrix \(A\). Instead, we solve the problem iteratively so that we never need to construct \(A\) globally but only need \(Ax\) that can be evaluated locally by virtue of the DG formulation. This action of the operator is what we have to supply in each step of the iterative algorithms implemented here. It is where most of the computational cost goes and usually involves computing a volume contribution for each element and communicating fluxes with neighboring elements. Since the iterative algorithms typically scale badly with increasing grid size, a preconditioner \(P\) is needed in order to make \(P^{-1}A\) easier to invert.</p>
<p>In the iterative algorithms we usually don't work with the physical field \(x\) directly. Instead we need to apply the operator to an internal variable defined by the respective algorithm. This variable is exposed as the <code><a class="el" href="structLinearSolver_1_1Tags_1_1Operand.html" title="The operand that the local linear operator  is applied to. ">LinearSolver::Tags::Operand</a></code> prefix, and the algorithm expects that the computed operator action is written into <code><a class="el" href="group__DataBoxTagsGroup.html#gab3e7a8857504fa5070c052bacba656cd" title="Wrap Tag in Prefix&lt;_, Args...&gt;, also wrapping variables tags if Tag is a Tags::Variables. ">db::add_tag_prefix</a>&lt;<a class="el" href="structLinearSolver_1_1Tags_1_1OperatorAppliedTo.html" title="The linear operator  applied to the data in Tag ">LinearSolver::Tags::OperatorAppliedTo</a>, <a class="el" href="structLinearSolver_1_1Tags_1_1Operand.html" title="The operand that the local linear operator  is applied to. ">LinearSolver::Tags::Operand</a>&lt;...&gt;&gt;</code> in each step.</p>
<p>Each linear solver is expected to expose the following compile-time interface:</p><ul>
<li><code>component_list</code>: A <code>tmpl::list</code> that collects the additional parallel components this linear solver uses. The executables will append these to their own <code>component_list</code>.</li>
<li><code>initialize_element</code>: An action that initializes the DataBox items required by the linear solver.</li>
<li><code>reinitialize_element</code>: An action that resets the linear solver to its initial state.</li>
<li><code>perform_step</code>: The action to be executed after the linear operator has been applied to the operand and written to the DataBox (see above). It will converge the fields towards their solution and update the operand before handing responsibility back to the algorithm for the next application of the linear operator: <div class="fragment"><div class="line">  <span class="keyword">using</span> phase_dependent_action_list = tmpl::list&lt;</div><div class="line">      <a class="code" href="structParallel_1_1PhaseActions.html">Parallel::PhaseActions</a>&lt;</div><div class="line">          <span class="keyword">typename</span> Metavariables::Phase, Metavariables::Phase::Initialization,</div><div class="line">          tmpl::list&lt;InitializeElement,</div><div class="line">                     <span class="keyword">typename</span> Metavariables::linear_solver::initialize_element,</div><div class="line">                     <a class="code" href="structParallel_1_1Actions_1_1TerminatePhase.html">Parallel::Actions::TerminatePhase</a>&gt;&gt;,</div><div class="line"></div><div class="line">      <a class="code" href="structParallel_1_1PhaseActions.html">Parallel::PhaseActions</a>&lt;</div><div class="line">          <span class="keyword">typename</span> Metavariables::Phase,</div><div class="line">          Metavariables::Phase::PerformLinearSolve,</div><div class="line">          tmpl::list&lt;<a class="code" href="structLinearSolver_1_1Actions_1_1TerminateIfConverged.html">LinearSolver::Actions::TerminateIfConverged</a>,</div><div class="line">                     <span class="keyword">typename</span> Metavariables::linear_solver::prepare_step,</div><div class="line">                     ComputeOperatorAction,</div><div class="line">                     <span class="keyword">typename</span> Metavariables::linear_solver::perform_step&gt;&gt;,</div><div class="line"></div><div class="line">      <a class="code" href="structParallel_1_1PhaseActions.html">Parallel::PhaseActions</a>&lt;<span class="keyword">typename</span> Metavariables::Phase,</div><div class="line">                             Metavariables::Phase::TestResult,</div><div class="line">                             tmpl::list&lt;TestResult&gt;&gt;&gt;;</div></div><!-- fragment --></li>
</ul>
<h2 class="groupheader">Function Documentation</h2>
<a id="ga9f4f80fb21f848e2fac02bebe6c1d1e0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga9f4f80fb21f848e2fac02bebe6c1d1e0">&#9670;&nbsp;</a></span>inner_product()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Lhs , typename Rhs &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double LinearSolver::inner_product </td>
          <td>(</td>
          <td class="paramtype">const Lhs &amp;&#160;</td>
          <td class="paramname"><em>lhs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Rhs &amp;&#160;</td>
          <td class="paramname"><em>rhs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The local part of the Euclidean inner product on the vector space w.r.t. which the addition and scalar multiplication of both <code>Lhs</code> and <code>Rhs</code> is defined. </p>
<h3>Details</h3>
<p>The linear solver works under the following assumptions:</p><ul>
<li>The data represented by <code>lhs</code> and <code>rhs</code> can each be interpreted as the local chunk of a vector of the same vector space \(V\). <em>Local</em> means there are vectors \(q, p\in V\) such that <code>lhs</code> and <code>rhs</code> represent the components of these vectors w.r.t. a subset \(B_i\) of a basis \(B\subset V\).</li>
<li>The <code>*</code> and <code>+</code> operators of <code>Lhs</code> and <code>Rhs</code> implement the scalar multiplication and addition in the vector space <em>locally</em>, i.e. restricted to \(B_i\) in the above sense.</li>
<li>The inner product is the local part \(\langle p,q\rangle|_{B_i}\) of the standard Euclidean dot product in the vector space so that globally it is \(\langle p,q\rangle=\sum_{i}\langle p,q\rangle|_{B_i}\) for \(B=\mathop{\dot{\bigcup}}_i B_i\).</li>
</ul>
<p>In practice this means that the full vectors \(p\) and \(q\) can be distributed on many elements, where each only holds local chunks <code>lhs</code> and <code>rhs</code> of the components. Scalar multiplication and addition can be performed locally as expected, but computing the full inner product requires a global reduction over all elements that sums their local <code>inner_product</code>s. </p>

</div>
</div>
</div><!-- contents -->
<!-- HTML footer for doxygen 1.8.10-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
&copy; Copyright 2017 - 2019
<a href="https://black-holes.org">SXS Collaboration</a>,
<a href="LICENSE.txt" target="_blank">
<span class="hidden-xs">Distributed under the</span>
MIT License</a>
</small></address>
</body>
</html>
