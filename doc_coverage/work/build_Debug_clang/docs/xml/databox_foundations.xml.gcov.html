<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<html lang="en">

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <title>LCOV - b1f4fe8326c5dc9de3d64954e9325e08a2677cfd - /work/build_Debug_clang/docs/xml/databox_foundations.xml</title>
  <link rel="stylesheet" type="text/css" href="../../../../gcov.css">
</head>

<body>

  <table width="100%" border=0 cellspacing=0 cellpadding=0>
    <tr><td class="title"> SpECTRE Documentation Coverage Report</td></tr>
    <tr><td class="ruler"><img src="../../../../glass.png" width=3 height=3 alt=""></td></tr>

    <tr>
      <td width="100%">
        <table cellpadding=1 border=0 width="100%">
          <tr>
            <td width="10%" class="headerItem">Current view:</td>
            <td width="35%" class="headerValue"><a href="../../../../index.html">top level</a> - <a href="index.html">work/build_Debug_clang/docs/xml</a> - databox_foundations.xml</td>
            <td width="5%"></td>
            <td width="15%"></td>
            <td width="10%" class="headerCovTableHead">Hit</td>
            <td width="10%" class="headerCovTableHead">Total</td>
            <td width="15%" class="headerCovTableHead">Coverage</td>
          </tr>
          <tr>
             <td class="headerItem">Commit:</td>
             <td class="headerValue"><a target="_blank" href="https://github.com/sxs-collaboration/spectre/commit/b1f4fe8326c5dc9de3d64954e9325e08a2677cfd">b1f4fe8326c5dc9de3d64954e9325e08a2677cfd</a></td>
            <td></td>
            <td class="headerItem">Lines:</td>
            <td class="headerCovTableEntry">1</td>
            <td class="headerCovTableEntry">1</td>
            <td class="headerCovTableEntryHi">100.0 %</td>
          </tr>
          <tr>
            <td class="headerItem">Date:</td>
            <td class="headerValue">2019-10-20 17:39:50</td>
            <td></td>
          </tr>
          <tr>
            <td class="headerItem">Legend:</td>
            <td class="headerValueLeg">            Lines:
            <span class="coverLegendCov">hit</span>
            <span class="coverLegendNoCov">not hit</span>
</td>
            <td></td>
          </tr>
          <tr><td><img src="../../../../glass.png" width=3 height=3 alt=""></td></tr>
        </table>
      </td>
    </tr>

    <tr><td class="ruler"><img src="../../../../glass.png" width=3 height=3 alt=""></td></tr>
  </table>

  <table cellpadding=0 cellspacing=0 border=0>
    <tr>
      <td><br></td>
    </tr>
    <tr>
      <td>
<pre class="sourceHeading">          Line data    Source code</pre>
<pre class="source">
<span class="lineNum">       1 </span><span class="lineCov">          1 : &lt;?xml version='1.0' encoding='UTF-8' standalone='no'?&gt;</span>
<span class="lineNum">       2 </span>            : &lt;doxygen xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xsi:noNamespaceSchemaLocation=&quot;compound.xsd&quot; version=&quot;1.8.13&quot;&gt;
<span class="lineNum">       3 </span>            :   &lt;compounddef id=&quot;databox_foundations&quot; kind=&quot;page&quot;&gt;
<span class="lineNum">       4 </span>            :     &lt;compoundname&gt;databox_foundations&lt;/compoundname&gt;
<span class="lineNum">       5 </span>            :     &lt;title&gt;Motivation for SpECTRE&amp;apos;s DataBox&lt;/title&gt;
<span class="lineNum">       6 </span>            :     &lt;detaileddescription&gt;
<span class="lineNum">       7 </span>            : &lt;sect1 id=&quot;databox_foundations_1databox_introduction&quot;&gt;
<span class="lineNum">       8 </span>            : &lt;title&gt;Introduction&lt;/title&gt;
<span class="lineNum">       9 </span>            : &lt;para&gt;This page walks the user through the iterative process that led to SpECTRE&amp;apos;s DataBox. At each stage, it discusses the advances and challenges that result from each improvement.&lt;/para&gt;&lt;/sect1&gt;
<span class="lineNum">      10 </span>            : &lt;sect1 id=&quot;databox_foundations_1databox_towards_spectres_databox&quot;&gt;
<span class="lineNum">      11 </span>            : &lt;title&gt;Towards SpECTRE&amp;apos;s DataBox&lt;/title&gt;
<span class="lineNum">      12 </span>            : &lt;sect2 id=&quot;databox_foundations_1databox_working_without_databoxes&quot;&gt;
<span class="lineNum">      13 </span>            : &lt;title&gt;Working without DataBoxes&lt;/title&gt;
<span class="lineNum">      14 </span>            : &lt;para&gt;In a small C++ program, it is common to use the built-in fundamental types (bool, int, double, etc.) in computations, and to give variable names to objects of these types. For example, a section of a small program may look like this:&lt;/para&gt;&lt;para&gt;&lt;programlisting&gt;&lt;codeline&gt;&lt;highlight class=&quot;comment&quot;&gt;//&lt;sp/&gt;Set&lt;sp/&gt;up&lt;sp/&gt;variables:&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      15 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;const&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keywordtype&quot;&gt;double&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;velocity&lt;sp/&gt;=&lt;sp/&gt;4.0;&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      16 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;const&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keywordtype&quot;&gt;double&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;radius&lt;sp/&gt;=&lt;sp/&gt;2.0;&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      17 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;const&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keywordtype&quot;&gt;double&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;density&lt;sp/&gt;=&lt;sp/&gt;0.5;&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      18 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;const&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keywordtype&quot;&gt;double&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;volume&lt;sp/&gt;=&lt;sp/&gt;10.0;&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      19 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      20 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;/highlight&gt;&lt;highlight class=&quot;comment&quot;&gt;//&lt;sp/&gt;Use&lt;sp/&gt;variables:&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      21 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;const&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keywordtype&quot;&gt;double&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;mass&lt;sp/&gt;=&lt;sp/&gt;density&lt;sp/&gt;*&lt;sp/&gt;volume;&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      22 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;const&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keywordtype&quot;&gt;double&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;acceleration&lt;sp/&gt;=&lt;sp/&gt;velocity&lt;sp/&gt;*&lt;sp/&gt;velocity&lt;sp/&gt;/&lt;sp/&gt;radius;&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      23 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keywordflow&quot;&gt;return&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;mass&lt;sp/&gt;*&lt;sp/&gt;acceleration;&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      24 </span>            : &lt;/programlisting&gt; What changes as our program&amp;apos;s size increases in scale? In SpECTRE, one of our driving design goals is modularity. In other words, functionality should be easy to swap in and out as desired. These smaller modules are easier to test, and keep the code flexible. We could wrap our calculation in such a module, which would then allow us to decouple the initial setup of the variables from where they are used in calculations:&lt;/para&gt;&lt;para&gt;&lt;programlisting&gt;&lt;codeline&gt;&lt;highlight class=&quot;keywordtype&quot;&gt;double&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;mass_compute(&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;const&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keywordtype&quot;&gt;double&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;density,&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;const&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keywordtype&quot;&gt;double&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;volume)&lt;sp/&gt;noexcept&lt;sp/&gt;{&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      25 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keywordflow&quot;&gt;return&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;density&lt;sp/&gt;*&lt;sp/&gt;volume;&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      26 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;}&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      27 </span>            : &lt;/programlisting&gt; &lt;programlisting&gt;&lt;codeline&gt;&lt;highlight class=&quot;keywordtype&quot;&gt;double&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;acceleration_compute(&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      28 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;const&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keywordtype&quot;&gt;double&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;velocity,&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;const&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keywordtype&quot;&gt;double&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;radius)&lt;sp/&gt;noexcept&lt;sp/&gt;{&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      29 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keywordflow&quot;&gt;return&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;velocity&lt;sp/&gt;*&lt;sp/&gt;velocity&lt;sp/&gt;/&lt;sp/&gt;radius;&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      30 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;}&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      31 </span>            : &lt;/programlisting&gt; Our small program can now be written as:&lt;/para&gt;&lt;para&gt;&lt;programlisting&gt;&lt;codeline&gt;&lt;highlight class=&quot;comment&quot;&gt;//&lt;sp/&gt;Set&lt;sp/&gt;up&lt;sp/&gt;variables:&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      32 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;const&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keywordtype&quot;&gt;double&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;velocity&lt;sp/&gt;=&lt;sp/&gt;4.0;&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      33 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;const&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keywordtype&quot;&gt;double&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;radius&lt;sp/&gt;=&lt;sp/&gt;2.0;&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      34 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;const&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keywordtype&quot;&gt;double&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;density&lt;sp/&gt;=&lt;sp/&gt;0.5;&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      35 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;const&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keywordtype&quot;&gt;double&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;volume&lt;sp/&gt;=&lt;sp/&gt;10.0;&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      36 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      37 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;/highlight&gt;&lt;highlight class=&quot;comment&quot;&gt;//&lt;sp/&gt;Use&lt;sp/&gt;variables:&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      38 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;const&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keywordtype&quot;&gt;double&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;mass&lt;sp/&gt;=&lt;sp/&gt;mass_compute(density,&lt;sp/&gt;volume);&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      39 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;const&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keywordtype&quot;&gt;double&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;acceleration&lt;sp/&gt;=&lt;sp/&gt;acceleration_compute(velocity,&lt;sp/&gt;radius);&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      40 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keywordflow&quot;&gt;return&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;mass&lt;sp/&gt;*&lt;sp/&gt;acceleration;&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      41 </span>            : &lt;/programlisting&gt; One advantage is immediate: we are free to add other computation modules that are independently testable and reusable. As the number of routines grows, we can even begin to write routines that work on top of existing ones.&lt;/para&gt;&lt;para&gt;&lt;programlisting&gt;&lt;codeline&gt;&lt;highlight class=&quot;keywordtype&quot;&gt;double&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;force_compute(&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;const&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keywordtype&quot;&gt;double&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;velocity,&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;const&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keywordtype&quot;&gt;double&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;radius,&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      42 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;const&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keywordtype&quot;&gt;double&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;density,&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;const&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keywordtype&quot;&gt;double&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;volume)&lt;sp/&gt;noexcept&lt;sp/&gt;{&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      43 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;const&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keywordtype&quot;&gt;double&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;mass&lt;sp/&gt;=&lt;sp/&gt;mass_compute(density,&lt;sp/&gt;volume);&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      44 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;const&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keywordtype&quot;&gt;double&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;acceleration&lt;sp/&gt;=&lt;sp/&gt;acceleration_compute(velocity,&lt;sp/&gt;radius);&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      45 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keywordflow&quot;&gt;return&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;mass&lt;sp/&gt;*&lt;sp/&gt;&lt;sp/&gt;acceleration;&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      46 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;}&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      47 </span>            : &lt;/programlisting&gt; While we have made progress, two problems arise. Our first problem is that as the number of quantities grows, it becomes more unwieldy to have to specify each function argument in our routine. The second problem is worse: the arguments passed to functions can be transposed and the program will still compile and run, but produce incorrect output. For example, the following two lines are equally well-formed from the point of view of the program:&lt;/para&gt;&lt;para&gt;&lt;programlisting&gt;&lt;codeline&gt;&lt;highlight class=&quot;keyword&quot;&gt;const&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keywordtype&quot;&gt;double&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;velocity&lt;sp/&gt;=&lt;sp/&gt;4.0;&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      48 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;const&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keywordtype&quot;&gt;double&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;radius&lt;sp/&gt;=&lt;sp/&gt;2.0;&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      49 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;const&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keywordtype&quot;&gt;double&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;acceleration&lt;sp/&gt;=&lt;sp/&gt;acceleration_compute(velocity,&lt;sp/&gt;radius);&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      50 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;const&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keywordtype&quot;&gt;double&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;failed_acceleration&lt;sp/&gt;=&lt;sp/&gt;acceleration_compute(radius,&lt;sp/&gt;velocity);&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      51 </span>            : &lt;/programlisting&gt; Every time we call &lt;computeroutput&gt;acceleration_compute&lt;/computeroutput&gt; we need to make sure we pass in the arguments in the correct order. In large programs where &lt;computeroutput&gt;acceleration_compute&lt;/computeroutput&gt; is called many times, it becomes inevitable that the arguments will be accidentally transposed. We can address the two problems described above with a &lt;computeroutput&gt;&lt;ref refid=&quot;cpp/container/map&quot; kindref=&quot;compound&quot; external=&quot;/work/spectre/docs/config/cppreference-doxygen-web.tag.xml&quot;&gt;std::map&lt;/ref&gt;&lt;/computeroutput&gt;, the first container we&amp;apos;ll consider in this series.&lt;/para&gt;&lt;/sect2&gt;
<span class="lineNum">      52 </span>            : &lt;sect2 id=&quot;databox_foundations_1databox_a_std_map_databox&quot;&gt;
<span class="lineNum">      53 </span>            : &lt;title&gt;A std::map DataBox&lt;/title&gt;
<span class="lineNum">      54 </span>            : &lt;para&gt;We can encapsulate the variables we use in a &lt;computeroutput&gt;&lt;ref refid=&quot;cpp/container/map&quot; kindref=&quot;compound&quot; external=&quot;/work/spectre/docs/config/cppreference-doxygen-web.tag.xml&quot;&gt;std::map&lt;/ref&gt;&lt;/computeroutput&gt;, and the first half of our small program example now looks like this:&lt;/para&gt;&lt;para&gt;&lt;programlisting&gt;&lt;codeline&gt;&lt;highlight class=&quot;comment&quot;&gt;//&lt;sp/&gt;Set&lt;sp/&gt;up&lt;sp/&gt;variables:&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      55 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;const&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keywordtype&quot;&gt;double&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;velocity&lt;sp/&gt;=&lt;sp/&gt;4.0;&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      56 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;const&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keywordtype&quot;&gt;double&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;radius&lt;sp/&gt;=&lt;sp/&gt;2.0;&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      57 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;const&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keywordtype&quot;&gt;double&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;density&lt;sp/&gt;=&lt;sp/&gt;0.5;&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      58 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;const&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keywordtype&quot;&gt;double&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;volume&lt;sp/&gt;=&lt;sp/&gt;10.0;&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      59 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      60 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;/highlight&gt;&lt;highlight class=&quot;comment&quot;&gt;//&lt;sp/&gt;Set&lt;sp/&gt;up&lt;sp/&gt;databox:&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      61 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;ref refid=&quot;cpp/container/map&quot; kindref=&quot;compound&quot; external=&quot;/work/spectre/docs/config/cppreference-doxygen-web.tag.xml&quot;&gt;std::map&amp;lt;std::string, double&amp;gt;&lt;/ref&gt;&lt;sp/&gt;naive_databox;&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      62 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;naive_databox[&lt;/highlight&gt;&lt;highlight class=&quot;stringliteral&quot;&gt;&amp;quot;Velocity&amp;quot;&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;]&lt;sp/&gt;=&lt;sp/&gt;velocity;&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      63 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;naive_databox[&lt;/highlight&gt;&lt;highlight class=&quot;stringliteral&quot;&gt;&amp;quot;Radius&amp;quot;&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;]&lt;sp/&gt;=&lt;sp/&gt;radius;&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      64 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;naive_databox[&lt;/highlight&gt;&lt;highlight class=&quot;stringliteral&quot;&gt;&amp;quot;Density&amp;quot;&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;]&lt;sp/&gt;=&lt;sp/&gt;density;&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      65 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;naive_databox[&lt;/highlight&gt;&lt;highlight class=&quot;stringliteral&quot;&gt;&amp;quot;Volume&amp;quot;&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;]&lt;sp/&gt;=&lt;sp/&gt;volume;&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      66 </span>            : &lt;/programlisting&gt; We have not yet taken full advantage of the encapsulation that &lt;computeroutput&gt;&lt;ref refid=&quot;cpp/container/map&quot; kindref=&quot;compound&quot; external=&quot;/work/spectre/docs/config/cppreference-doxygen-web.tag.xml&quot;&gt;std::map&lt;/ref&gt;&lt;/computeroutput&gt; provides. We do so by rewriting our other routines to take only a single argument, i.e. the &lt;computeroutput&gt;&lt;ref refid=&quot;cpp/container/map&quot; kindref=&quot;compound&quot; external=&quot;/work/spectre/docs/config/cppreference-doxygen-web.tag.xml&quot;&gt;std::map&lt;/ref&gt;&lt;/computeroutput&gt; itself:&lt;/para&gt;&lt;para&gt;&lt;programlisting&gt;&lt;codeline&gt;&lt;highlight class=&quot;keywordtype&quot;&gt;double&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;mass_compute(&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;const&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;ref refid=&quot;cpp/container/map&quot; kindref=&quot;compound&quot; external=&quot;/work/spectre/docs/config/cppreference-doxygen-web.tag.xml&quot;&gt;std::map&amp;lt;std::string, double&amp;gt;&lt;/ref&gt;&amp;amp;&lt;sp/&gt;box)&lt;sp/&gt;noexcept&lt;sp/&gt;{&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      67 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keywordflow&quot;&gt;return&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;box.at(&lt;/highlight&gt;&lt;highlight class=&quot;stringliteral&quot;&gt;&amp;quot;Density&amp;quot;&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;)&lt;sp/&gt;*&lt;sp/&gt;box.at(&lt;/highlight&gt;&lt;highlight class=&quot;stringliteral&quot;&gt;&amp;quot;Volume&amp;quot;&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;);&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      68 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;}&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      69 </span>            : &lt;/programlisting&gt; &lt;programlisting&gt;&lt;codeline&gt;&lt;highlight class=&quot;keywordtype&quot;&gt;double&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;acceleration_compute(&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;const&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;ref refid=&quot;cpp/container/map&quot; kindref=&quot;compound&quot; external=&quot;/work/spectre/docs/config/cppreference-doxygen-web.tag.xml&quot;&gt;std::map&amp;lt;std::string, double&amp;gt;&lt;/ref&gt;&amp;amp;&lt;sp/&gt;box)&lt;sp/&gt;noexcept&lt;sp/&gt;{&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      70 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keywordflow&quot;&gt;return&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;box.at(&lt;/highlight&gt;&lt;highlight class=&quot;stringliteral&quot;&gt;&amp;quot;Velocity&amp;quot;&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;)&lt;sp/&gt;*&lt;sp/&gt;box.at(&lt;/highlight&gt;&lt;highlight class=&quot;stringliteral&quot;&gt;&amp;quot;Velocity&amp;quot;&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;)&lt;sp/&gt;/&lt;sp/&gt;box.at(&lt;/highlight&gt;&lt;highlight class=&quot;stringliteral&quot;&gt;&amp;quot;Radius&amp;quot;&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;);&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      71 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;}&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      72 </span>            : &lt;/programlisting&gt; Notice that this solves the problem of having to provide the arguments in the correct order to every function call of &lt;computeroutput&gt;acceleration_compute&lt;/computeroutput&gt;:&lt;/para&gt;&lt;para&gt;&lt;programlisting&gt;&lt;codeline&gt;&lt;highlight class=&quot;keywordtype&quot;&gt;double&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;force_compute(&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;const&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;ref refid=&quot;cpp/container/map&quot; kindref=&quot;compound&quot; external=&quot;/work/spectre/docs/config/cppreference-doxygen-web.tag.xml&quot;&gt;std::map&amp;lt;std::string, double&amp;gt;&lt;/ref&gt;&amp;amp;&lt;sp/&gt;box)&lt;sp/&gt;noexcept&lt;sp/&gt;{&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      73 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;const&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keywordtype&quot;&gt;double&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;mass&lt;sp/&gt;=&lt;sp/&gt;mass_compute(box);&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      74 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;const&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keywordtype&quot;&gt;double&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;acceleration&lt;sp/&gt;=&lt;sp/&gt;acceleration_compute(box);&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      75 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keywordflow&quot;&gt;return&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;mass&lt;sp/&gt;*&lt;sp/&gt;acceleration;&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      76 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;}&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      77 </span>            : &lt;/programlisting&gt;&lt;/para&gt;&lt;para&gt;Our small program now looks like:&lt;/para&gt;&lt;para&gt;&lt;programlisting&gt;&lt;codeline&gt;&lt;highlight class=&quot;comment&quot;&gt;//&lt;sp/&gt;Set&lt;sp/&gt;up&lt;sp/&gt;variables:&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      78 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;const&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keywordtype&quot;&gt;double&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;velocity&lt;sp/&gt;=&lt;sp/&gt;4.0;&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      79 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;const&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keywordtype&quot;&gt;double&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;radius&lt;sp/&gt;=&lt;sp/&gt;2.0;&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      80 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;const&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keywordtype&quot;&gt;double&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;density&lt;sp/&gt;=&lt;sp/&gt;0.5;&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      81 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;const&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keywordtype&quot;&gt;double&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;volume&lt;sp/&gt;=&lt;sp/&gt;10.0;&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      82 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      83 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;/highlight&gt;&lt;highlight class=&quot;comment&quot;&gt;//&lt;sp/&gt;Set&lt;sp/&gt;up&lt;sp/&gt;databox:&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      84 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;ref refid=&quot;cpp/container/map&quot; kindref=&quot;compound&quot; external=&quot;/work/spectre/docs/config/cppreference-doxygen-web.tag.xml&quot;&gt;std::map&amp;lt;std::string, double&amp;gt;&lt;/ref&gt;&lt;sp/&gt;naive_databox;&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      85 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;naive_databox[&lt;/highlight&gt;&lt;highlight class=&quot;stringliteral&quot;&gt;&amp;quot;Velocity&amp;quot;&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;]&lt;sp/&gt;=&lt;sp/&gt;velocity;&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      86 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;naive_databox[&lt;/highlight&gt;&lt;highlight class=&quot;stringliteral&quot;&gt;&amp;quot;Radius&amp;quot;&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;]&lt;sp/&gt;=&lt;sp/&gt;radius;&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      87 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;naive_databox[&lt;/highlight&gt;&lt;highlight class=&quot;stringliteral&quot;&gt;&amp;quot;Density&amp;quot;&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;]&lt;sp/&gt;=&lt;sp/&gt;density;&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      88 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;naive_databox[&lt;/highlight&gt;&lt;highlight class=&quot;stringliteral&quot;&gt;&amp;quot;Volume&amp;quot;&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;]&lt;sp/&gt;=&lt;sp/&gt;volume;&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      89 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      90 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;/highlight&gt;&lt;highlight class=&quot;comment&quot;&gt;//&lt;sp/&gt;Use&lt;sp/&gt;variables:&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      91 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keywordflow&quot;&gt;return&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;force_compute(naive_databox);&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      92 </span>            : &lt;/programlisting&gt; Within each function, we no longer need to worry about passing in the arguments in the correct order. This is a great improvement, but our reliance on proper names does leave us open to the following mistake:&lt;/para&gt;&lt;para&gt;&lt;programlisting&gt;&lt;codeline&gt;&lt;highlight class=&quot;comment&quot;&gt;//&lt;sp/&gt;returns&lt;sp/&gt;0&lt;sp/&gt;without&lt;sp/&gt;emitting&lt;sp/&gt;an&lt;sp/&gt;error!&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      93 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keywordflow&quot;&gt;return&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;naive_databox[&lt;/highlight&gt;&lt;highlight class=&quot;stringliteral&quot;&gt;&amp;quot;MisspelledKey&amp;quot;&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;];&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      94 </span>            : &lt;/programlisting&gt;&lt;/para&gt;&lt;para&gt;In the above example, the map is asked to return a value given a key that does not exist! As written, however, the program is well-formed and no error is emitted. (In the case of &lt;ref refid=&quot;cpp/container/map&quot; kindref=&quot;compound&quot; external=&quot;/work/spectre/docs/config/cppreference-doxygen-web.tag.xml&quot;&gt;std::map&lt;/ref&gt;, &lt;ulink url=&quot;https://en.cppreference.com/w/cpp/container/map/operator_at&quot;&gt;a value is created.&lt;/ulink&gt;) Because the keys are indistinguishable from their type alone, the mistake cannot be caught at compile time. In our example, the mistake won&amp;apos;t even be caught at run time. The run time portion of a SpECTRE calculation will typically be much longer (up to thousands of times longer!) than the compile time portion, so it is critical to catch costly mistakes like this as early into the calculation as possible. Although names encoded as &lt;computeroutput&gt;&lt;ref refid=&quot;cpp/string/basic_string&quot; kindref=&quot;compound&quot; external=&quot;/work/spectre/docs/config/cppreference-doxygen-web.tag.xml&quot;&gt;std::string&lt;/ref&gt;&lt;/computeroutput&gt; cannot be distinguished by the compiler, names encoded as types &lt;emphasis&gt;can&lt;/emphasis&gt; be. This is possible with C++&amp;apos;s static typing, and to take advantage of this we need a container that is &lt;emphasis&gt;heterogeneous&lt;/emphasis&gt;, that is, capable of holding objects of different types.&lt;/para&gt;&lt;/sect2&gt;
<span class="lineNum">      95 </span>            : &lt;sect2 id=&quot;databox_foundations_1databox_a_std_tuple_databox&quot;&gt;
<span class="lineNum">      96 </span>            : &lt;title&gt;A std::tuple DataBox&lt;/title&gt;
<span class="lineNum">      97 </span>            : &lt;para&gt;A well-documented example of a fixed-size heterogeneous container of types is &lt;ulink url=&quot;https://en.cppreference.com/w/cpp/utility/tuple&quot;&gt;std::tuple&lt;/ulink&gt;:&lt;/para&gt;&lt;para&gt;&lt;programlisting&gt;&lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;ref refid=&quot;cpp/utility/tuple&quot; kindref=&quot;compound&quot; external=&quot;/work/spectre/docs/config/cppreference-doxygen-web.tag.xml&quot;&gt;std::tuple&amp;lt;double, size_t, bool&amp;gt;&lt;/ref&gt;&lt;sp/&gt;sophomore_databox&lt;sp/&gt;=&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      98 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;std::make_tuple(1.2,&lt;sp/&gt;8,&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;true&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;);&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">      99 </span>            : &lt;/programlisting&gt; The contents of the &lt;computeroutput&gt;std_tuple&lt;/computeroutput&gt; are obtained using &lt;ulink url=&quot;https://en.cppreference.com/w/cpp/utility/tuple/get&quot;&gt;std::get&lt;/ulink&gt;:&lt;/para&gt;&lt;para&gt;&lt;programlisting&gt;&lt;codeline&gt;&lt;highlight class=&quot;keyword&quot;&gt;const&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keywordtype&quot;&gt;bool&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;bool_quantity&lt;sp/&gt;=&lt;sp/&gt;std::get&amp;lt;bool&amp;gt;(sophomore_databox);&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     100 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;/highlight&gt;&lt;highlight class=&quot;comment&quot;&gt;//&lt;sp/&gt;value&lt;sp/&gt;obtained&lt;sp/&gt;is&lt;sp/&gt;`true`&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     101 </span>            : &lt;/programlisting&gt; In the above, we can see that we have promoted our keys from different values all of type &lt;computeroutput&gt;&lt;ref refid=&quot;cpp/string/basic_string&quot; kindref=&quot;compound&quot; external=&quot;/work/spectre/docs/config/cppreference-doxygen-web.tag.xml&quot;&gt;std::string&lt;/ref&gt;&lt;/computeroutput&gt; to different types entirely. We are not limited to fundamental types, we are free to make our own structs that serve as keys. These user-created types are called &lt;emphasis&gt;tags&lt;/emphasis&gt;.&lt;/para&gt;&lt;para&gt;As the sole purpose of the tag is to provide the compiler with a type distinguishable from other types, they can be as simple as the following:&lt;/para&gt;&lt;para&gt;&lt;programlisting&gt;&lt;codeline&gt;&lt;highlight class=&quot;keyword&quot;&gt;struct&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;Velocity{};&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     102 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;struct&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;Radius{};&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     103 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;struct&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;Density{};&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     104 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;struct&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;ref refid=&quot;group__ObserversGroup_1gga9601b9f188609201444e989ee8825b45abd7a9717d29c5ddcab1bc175eda1e298&quot; kindref=&quot;member&quot;&gt;Volume&lt;/ref&gt;{};&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     105 </span>            : &lt;/programlisting&gt; Note that we have now promoted &lt;computeroutput&gt;Velocity&lt;/computeroutput&gt;, &lt;computeroutput&gt;Radius&lt;/computeroutput&gt;, etc. from being &lt;emphasis&gt;values&lt;/emphasis&gt; associated with &lt;computeroutput&gt;&lt;ref refid=&quot;cpp/string/basic_string&quot; kindref=&quot;compound&quot; external=&quot;/work/spectre/docs/config/cppreference-doxygen-web.tag.xml&quot;&gt;std::string&lt;/ref&gt;&lt;/computeroutput&gt;s at run time, to &lt;emphasis&gt;types&lt;/emphasis&gt; distinguishable from other types at compile time. A large portion of SpECTRE is designed with the philosophy of enlisting the help of the compiler in assuring the correctness of our programs. An example of a &lt;computeroutput&gt;&lt;ref refid=&quot;cpp/utility/tuple&quot; kindref=&quot;compound&quot; external=&quot;/work/spectre/docs/config/cppreference-doxygen-web.tag.xml&quot;&gt;std::tuple&lt;/ref&gt;&lt;/computeroutput&gt; making use of these tags might look like:&lt;/para&gt;&lt;para&gt;&lt;programlisting&gt;&lt;codeline&gt;&lt;highlight class=&quot;comment&quot;&gt;//&lt;sp/&gt;Note:&lt;sp/&gt;This&lt;sp/&gt;won&amp;apos;t&lt;sp/&gt;work!&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     106 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;ref refid=&quot;cpp/utility/tuple&quot; kindref=&quot;compound&quot; external=&quot;/work/spectre/docs/config/cppreference-doxygen-web.tag.xml&quot;&gt;std::tuple&amp;lt;Velocity, Radius, Density, Volume&amp;gt;&lt;/ref&gt;&lt;sp/&gt;sophomore_databox&lt;sp/&gt;=&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     107 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;std::make_tuple(4.0,&lt;sp/&gt;2.0,&lt;sp/&gt;0.5,&lt;sp/&gt;10.0);&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     108 </span>            : &lt;/programlisting&gt;&lt;/para&gt;&lt;para&gt;Unfortunately, this will not work. The types passed as template parameters to &lt;computeroutput&gt;&lt;ref refid=&quot;cpp/utility/tuple&quot; kindref=&quot;compound&quot; external=&quot;/work/spectre/docs/config/cppreference-doxygen-web.tag.xml&quot;&gt;std::tuple&lt;/ref&gt;&lt;/computeroutput&gt; must also be the types of the arguments passed to &lt;computeroutput&gt;std::make_tuple&lt;/computeroutput&gt;. Using a &lt;computeroutput&gt;&lt;ref refid=&quot;cpp/utility/pair&quot; kindref=&quot;compound&quot; external=&quot;/work/spectre/docs/config/cppreference-doxygen-web.tag.xml&quot;&gt;std::pair&lt;/ref&gt;&lt;/computeroutput&gt;, we could write the above as:&lt;/para&gt;&lt;para&gt;&lt;programlisting&gt;&lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;ref refid=&quot;cpp/utility/tuple&quot; kindref=&quot;compound&quot; external=&quot;/work/spectre/docs/config/cppreference-doxygen-web.tag.xml&quot;&gt;std::tuple&amp;lt;std::pair&amp;lt;Velocity,double&amp;gt;&lt;/ref&gt;,&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     109 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;ref refid=&quot;cpp/utility/pair&quot; kindref=&quot;compound&quot; external=&quot;/work/spectre/docs/config/cppreference-doxygen-web.tag.xml&quot;&gt;std::pair&amp;lt;Radius, double&amp;gt;&lt;/ref&gt;,&lt;sp/&gt;&lt;ref refid=&quot;cpp/utility/pair&quot; kindref=&quot;compound&quot; external=&quot;/work/spectre/docs/config/cppreference-doxygen-web.tag.xml&quot;&gt;std::pair&amp;lt;Density, double&amp;gt;&lt;/ref&gt;,&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     110 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;ref refid=&quot;cpp/utility/pair&quot; kindref=&quot;compound&quot; external=&quot;/work/spectre/docs/config/cppreference-doxygen-web.tag.xml&quot;&gt;std::pair&amp;lt;Volume, double&amp;gt;&lt;/ref&gt;&amp;gt;&lt;sp/&gt;sophomore_databox&lt;sp/&gt;=&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     111 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;std::make_tuple(std::make_pair(Velocity{},&lt;sp/&gt;4.0),&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     112 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;std::make_pair(Radius{},&lt;sp/&gt;2.0),&lt;sp/&gt;std::make_pair(Density{},&lt;sp/&gt;0.5),&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     113 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;std::make_pair(Volume{},&lt;sp/&gt;10.0));&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     114 </span>            : &lt;/programlisting&gt; What remains is to rewrite our functions to use &lt;computeroutput&gt;&lt;ref refid=&quot;cpp/utility/tuple&quot; kindref=&quot;compound&quot; external=&quot;/work/spectre/docs/config/cppreference-doxygen-web.tag.xml&quot;&gt;std::tuple&lt;/ref&gt;&lt;/computeroutput&gt; instead of &lt;computeroutput&gt;&lt;ref refid=&quot;cpp/container/map&quot; kindref=&quot;compound&quot; external=&quot;/work/spectre/docs/config/cppreference-doxygen-web.tag.xml&quot;&gt;std::map&lt;/ref&gt;&lt;/computeroutput&gt;. Note that since we are now using a heterogeneous container of potentially unknown type, our functions must be templated on the pairs used to create the &lt;computeroutput&gt;sophomore_databox&lt;/computeroutput&gt;. Our functions then look like:&lt;/para&gt;&lt;para&gt;&lt;programlisting&gt;&lt;codeline&gt;&lt;highlight class=&quot;keyword&quot;&gt;template&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&amp;lt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;typename&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;...&lt;sp/&gt;Pairs&amp;gt;&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     115 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keywordtype&quot;&gt;double&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;mass_compute(&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;const&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;ref refid=&quot;cpp/utility/tuple&quot; kindref=&quot;compound&quot; external=&quot;/work/spectre/docs/config/cppreference-doxygen-web.tag.xml&quot;&gt;std::tuple&amp;lt;Pairs...&amp;gt;&lt;/ref&gt;&amp;amp;&lt;sp/&gt;box)&lt;sp/&gt;noexcept&lt;sp/&gt;{&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     116 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keywordflow&quot;&gt;return&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;std::get&amp;lt;std::pair&amp;lt;Density,&lt;sp/&gt;double&amp;gt;&amp;gt;(box).second&lt;sp/&gt;*&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     117 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;ref refid=&quot;group__DataStructuresGroup_1gabf5aa6d8efa0b2546f7e409a25b4f7dd&quot; kindref=&quot;member&quot;&gt;std::get&lt;/ref&gt;&amp;lt;&lt;ref refid=&quot;cpp/utility/pair&quot; kindref=&quot;compound&quot; external=&quot;/work/spectre/docs/config/cppreference-doxygen-web.tag.xml&quot;&gt;std::pair&amp;lt;Volume, double&amp;gt;&lt;/ref&gt;&amp;gt;(box).second;&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     118 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;}&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     119 </span>            : &lt;/programlisting&gt; &lt;programlisting&gt;&lt;codeline&gt;&lt;highlight class=&quot;keyword&quot;&gt;template&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&amp;lt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;typename&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;...&lt;sp/&gt;Pairs&amp;gt;&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     120 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keywordtype&quot;&gt;double&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;acceleration_compute(&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;const&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;ref refid=&quot;cpp/utility/tuple&quot; kindref=&quot;compound&quot; external=&quot;/work/spectre/docs/config/cppreference-doxygen-web.tag.xml&quot;&gt;std::tuple&amp;lt;Pairs...&amp;gt;&lt;/ref&gt;&amp;amp;&lt;sp/&gt;box)&lt;sp/&gt;noexcept&lt;sp/&gt;{&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     121 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keywordflow&quot;&gt;return&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;std::get&amp;lt;std::pair&amp;lt;Velocity,&lt;sp/&gt;double&amp;gt;&amp;gt;(box).second&lt;sp/&gt;*&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     122 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;ref refid=&quot;group__DataStructuresGroup_1gabf5aa6d8efa0b2546f7e409a25b4f7dd&quot; kindref=&quot;member&quot;&gt;std::get&lt;/ref&gt;&amp;lt;&lt;ref refid=&quot;cpp/utility/pair&quot; kindref=&quot;compound&quot; external=&quot;/work/spectre/docs/config/cppreference-doxygen-web.tag.xml&quot;&gt;std::pair&amp;lt;Velocity, double&amp;gt;&lt;/ref&gt;&amp;gt;(box).second&lt;sp/&gt;/&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     123 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;std::get&amp;lt;std::pair&amp;lt;Radius,&lt;sp/&gt;double&amp;gt;&amp;gt;(box).second;&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     124 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;}&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     125 </span>            : &lt;/programlisting&gt; &lt;programlisting&gt;&lt;codeline&gt;&lt;highlight class=&quot;keyword&quot;&gt;template&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&amp;lt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;typename&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;...&lt;sp/&gt;Pairs&amp;gt;&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     126 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keywordtype&quot;&gt;double&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;force_compute(&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;const&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;ref refid=&quot;cpp/utility/tuple&quot; kindref=&quot;compound&quot; external=&quot;/work/spectre/docs/config/cppreference-doxygen-web.tag.xml&quot;&gt;std::tuple&amp;lt;Pairs...&amp;gt;&lt;/ref&gt;&amp;amp;&lt;sp/&gt;box)&lt;sp/&gt;noexcept&lt;sp/&gt;{&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     127 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;const&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keywordtype&quot;&gt;double&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;mass&lt;sp/&gt;=&lt;sp/&gt;mass_compute(box);&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     128 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;const&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keywordtype&quot;&gt;double&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;acceleration&lt;sp/&gt;=&lt;sp/&gt;acceleration_compute(box);&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     129 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keywordflow&quot;&gt;return&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;mass&lt;sp/&gt;*&lt;sp/&gt;acceleration;&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     130 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;}&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     131 </span>            : &lt;/programlisting&gt; Using all these &lt;computeroutput&gt;&lt;ref refid=&quot;cpp/utility/pair&quot; kindref=&quot;compound&quot; external=&quot;/work/spectre/docs/config/cppreference-doxygen-web.tag.xml&quot;&gt;std::pair&lt;/ref&gt;&lt;/computeroutput&gt;s to get our &lt;computeroutput&gt;&lt;ref refid=&quot;cpp/utility/tuple&quot; kindref=&quot;compound&quot; external=&quot;/work/spectre/docs/config/cppreference-doxygen-web.tag.xml&quot;&gt;std::tuple&lt;/ref&gt;&lt;/computeroutput&gt; to work is a bit cumbersome. There is another way to package together the tagging ability of the struct names with the type information of the values we wish to store. To do this we need to make modifications to both our tags as well as our Databox implementation. This is what is done in SpECTRE&amp;apos;s &lt;computeroutput&gt;&lt;ref refid=&quot;classtuples_1_1TaggedTuple&quot; kindref=&quot;compound&quot;&gt;tuples::TaggedTuple&lt;/ref&gt;&lt;/computeroutput&gt;, which is an improved implementation of &lt;computeroutput&gt;&lt;ref refid=&quot;cpp/utility/tuple&quot; kindref=&quot;compound&quot; external=&quot;/work/spectre/docs/config/cppreference-doxygen-web.tag.xml&quot;&gt;std::tuple&lt;/ref&gt;&lt;/computeroutput&gt; in terms of both performance and interface.&lt;/para&gt;&lt;/sect2&gt;
<span class="lineNum">     132 </span>            : &lt;sect2 id=&quot;databox_foundations_1databox_a_taggedtuple_databox&quot;&gt;
<span class="lineNum">     133 </span>            : &lt;title&gt;A TaggedTuple DataBox&lt;/title&gt;
<span class="lineNum">     134 </span>            : &lt;para&gt;TaggedTuple is an implementation of a compile time container where the keys are tags.&lt;/para&gt;&lt;para&gt;Tags that are compatible with SpECTRE&amp;apos;s &lt;computeroutput&gt;&lt;ref refid=&quot;classtuples_1_1TaggedTuple&quot; kindref=&quot;compound&quot;&gt;tuples::TaggedTuple&lt;/ref&gt;&lt;/computeroutput&gt; must have the type alias &lt;computeroutput&gt;type&lt;/computeroutput&gt; in their structs. This type alias carries the type information of the data we wish to store in the databox. &lt;computeroutput&gt;&lt;ref refid=&quot;classtuples_1_1TaggedTuple&quot; kindref=&quot;compound&quot;&gt;tuples::TaggedTuple&lt;/ref&gt;&lt;/computeroutput&gt; is able to make use of this type information so we won&amp;apos;t need auxiliary constructs such as &lt;computeroutput&gt;&lt;ref refid=&quot;cpp/utility/pair&quot; kindref=&quot;compound&quot; external=&quot;/work/spectre/docs/config/cppreference-doxygen-web.tag.xml&quot;&gt;std::pair&lt;/ref&gt;&lt;/computeroutput&gt; to package this information together anymore. Our new tags now look like:&lt;/para&gt;&lt;para&gt;&lt;programlisting&gt;&lt;codeline&gt;&lt;highlight class=&quot;keyword&quot;&gt;struct&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;Velocity&lt;sp/&gt;{&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     135 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;using&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;type&lt;sp/&gt;=&lt;sp/&gt;double;&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     136 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;};&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     137 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;struct&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;Radius&lt;sp/&gt;{&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     138 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;using&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;type&lt;sp/&gt;=&lt;sp/&gt;double;&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     139 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;};&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     140 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;struct&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;Density&lt;sp/&gt;{&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     141 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;using&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;type&lt;sp/&gt;=&lt;sp/&gt;double;&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     142 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;};&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     143 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;struct&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;ref refid=&quot;group__ObserversGroup_1gga9601b9f188609201444e989ee8825b45abd7a9717d29c5ddcab1bc175eda1e298&quot; kindref=&quot;member&quot;&gt;Volume&lt;/ref&gt;&lt;sp/&gt;{&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     144 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;using&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;type&lt;sp/&gt;=&lt;sp/&gt;double;&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     145 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;};&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     146 </span>            : &lt;/programlisting&gt; We are now able to create the &lt;computeroutput&gt;junior_databox&lt;/computeroutput&gt; below in the same way we initially wished to create the &lt;computeroutput&gt;sophomore_databox&lt;/computeroutput&gt; above:&lt;/para&gt;&lt;para&gt;&lt;programlisting&gt;&lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;ref refid=&quot;classtuples_1_1TaggedTuple&quot; kindref=&quot;compound&quot;&gt;tuples::TaggedTuple&amp;lt;Velocity, Radius, Density, Volume&amp;gt;&lt;/ref&gt;&lt;sp/&gt;junior_databox{&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     147 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;4.0,&lt;sp/&gt;2.0,&lt;sp/&gt;0.5,&lt;sp/&gt;10.0};&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     148 </span>            : &lt;/programlisting&gt; Our functions similarly simplify:&lt;/para&gt;&lt;para&gt;&lt;programlisting&gt;&lt;codeline&gt;&lt;highlight class=&quot;keyword&quot;&gt;template&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&amp;lt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;typename&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;...&lt;sp/&gt;&lt;ref refid=&quot;namespaceTags&quot; kindref=&quot;compound&quot;&gt;Tags&lt;/ref&gt;&amp;gt;&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     149 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keywordtype&quot;&gt;double&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;mass_compute(&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;const&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;ref refid=&quot;classtuples_1_1TaggedTuple&quot; kindref=&quot;compound&quot;&gt;tuples::TaggedTuple&amp;lt;Tags...&amp;gt;&lt;/ref&gt;&amp;amp;&lt;sp/&gt;box)&lt;sp/&gt;noexcept&lt;sp/&gt;{&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     150 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keywordflow&quot;&gt;return&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;tuples::get&amp;lt;Density&amp;gt;(box)&lt;sp/&gt;*&lt;sp/&gt;tuples::get&amp;lt;Volume&amp;gt;(box);&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     151 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;}&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     152 </span>            : &lt;/programlisting&gt; &lt;programlisting&gt;&lt;codeline&gt;&lt;highlight class=&quot;keyword&quot;&gt;template&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&amp;lt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;typename&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;...&lt;sp/&gt;&lt;ref refid=&quot;namespaceTags&quot; kindref=&quot;compound&quot;&gt;Tags&lt;/ref&gt;&amp;gt;&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     153 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keywordtype&quot;&gt;double&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;acceleration_compute(&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;const&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;ref refid=&quot;classtuples_1_1TaggedTuple&quot; kindref=&quot;compound&quot;&gt;tuples::TaggedTuple&amp;lt;Tags...&amp;gt;&lt;/ref&gt;&amp;amp;&lt;sp/&gt;box)&lt;sp/&gt;noexcept&lt;sp/&gt;{&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     154 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keywordflow&quot;&gt;return&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;tuples::get&amp;lt;Velocity&amp;gt;(box)&lt;sp/&gt;*&lt;sp/&gt;tuples::get&amp;lt;Velocity&amp;gt;(box)&lt;sp/&gt;/&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     155 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;tuples::get&amp;lt;Radius&amp;gt;(box);&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     156 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;}&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     157 </span>            : &lt;/programlisting&gt; &lt;programlisting&gt;&lt;codeline&gt;&lt;highlight class=&quot;keyword&quot;&gt;template&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&amp;lt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;typename&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;...&lt;sp/&gt;&lt;ref refid=&quot;namespaceTags&quot; kindref=&quot;compound&quot;&gt;Tags&lt;/ref&gt;&amp;gt;&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     158 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keywordtype&quot;&gt;double&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;force_compute(&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;const&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;ref refid=&quot;classtuples_1_1TaggedTuple&quot; kindref=&quot;compound&quot;&gt;tuples::TaggedTuple&amp;lt;Tags...&amp;gt;&lt;/ref&gt;&amp;amp;&lt;sp/&gt;box)&lt;sp/&gt;noexcept&lt;sp/&gt;{&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     159 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;const&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keywordtype&quot;&gt;double&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;mass&lt;sp/&gt;=&lt;sp/&gt;mass_compute(box);&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     160 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;const&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keywordtype&quot;&gt;double&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;acceleration&lt;sp/&gt;=&lt;sp/&gt;acceleration_compute(box);&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     161 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keywordflow&quot;&gt;return&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;mass&lt;sp/&gt;*&lt;sp/&gt;acceleration;&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     162 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;}&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     163 </span>            : &lt;/programlisting&gt; In each of these iterations of the Databox, we started with initial quantities and computed subsequent quantities. Let us consider again &lt;computeroutput&gt;force_compute&lt;/computeroutput&gt;, in which &lt;computeroutput&gt;mass&lt;/computeroutput&gt; and &lt;computeroutput&gt;acceleration&lt;/computeroutput&gt; are recomputed for every call to &lt;computeroutput&gt;force_compute&lt;/computeroutput&gt;. If &lt;computeroutput&gt;Mass&lt;/computeroutput&gt; and &lt;computeroutput&gt;Acceleration&lt;/computeroutput&gt; were tags somewhow, that is, if we could compute them once, place them in the databox, and get them back out through the use of tags, we could get around this problem. We are now ready to consider SpECTRE&amp;apos;s DataBox, which provides the solution to this problem in the form of &lt;computeroutput&gt;ComputeTags&lt;/computeroutput&gt;.&lt;/para&gt;&lt;/sect2&gt;
<span class="lineNum">     164 </span>            : &lt;/sect1&gt;
<span class="lineNum">     165 </span>            : &lt;sect1 id=&quot;databox_foundations_1databox_a_proper_databox&quot;&gt;
<span class="lineNum">     166 </span>            : &lt;title&gt;SpECTRE&amp;apos;s DataBox&lt;/title&gt;
<span class="lineNum">     167 </span>            : &lt;para&gt;A brief description of SpECTRE&amp;apos;s DataBox: a TaggedTuple with compute-on-demand. For a detailed description of SpECTRE&amp;apos;s DataBox, see the &lt;ref refid=&quot;group__DataBoxGroup&quot; kindref=&quot;compound&quot;&gt;DataBox documentation&lt;/ref&gt;.&lt;/para&gt;&lt;sect2 id=&quot;databox_foundations_1databox_documentation_for_simple_tags&quot;&gt;
<span class="lineNum">     168 </span>            : &lt;title&gt;SimpleTags&lt;/title&gt;
<span class="lineNum">     169 </span>            : &lt;para&gt;Just as we needed to modify our tags to make them compatible with &lt;computeroutput&gt;TaggedTuple&lt;/computeroutput&gt;, we need to again modify them for use with DataBox. Our ordinary tags become SpECTRE&amp;apos;s SimpleTags:&lt;/para&gt;&lt;para&gt;&lt;programlisting&gt;&lt;codeline&gt;&lt;highlight class=&quot;keyword&quot;&gt;struct&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;Velocity&lt;sp/&gt;:&lt;sp/&gt;&lt;ref refid=&quot;structdb_1_1SimpleTag&quot; kindref=&quot;compound&quot;&gt;db::SimpleTag&lt;/ref&gt;&lt;sp/&gt;{&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     170 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;using&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;type&lt;sp/&gt;=&lt;sp/&gt;double;&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     171 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;static&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;ref refid=&quot;cpp/string/basic_string&quot; kindref=&quot;compound&quot; external=&quot;/work/spectre/docs/config/cppreference-doxygen-web.tag.xml&quot;&gt;std::string&lt;/ref&gt;&lt;sp/&gt;name()&lt;sp/&gt;noexcept&lt;sp/&gt;{&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keywordflow&quot;&gt;return&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;stringliteral&quot;&gt;&amp;quot;Velocity&amp;quot;&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;;&lt;sp/&gt;}&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     172 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;};&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     173 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;struct&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;Radius&lt;sp/&gt;:&lt;sp/&gt;&lt;ref refid=&quot;structdb_1_1SimpleTag&quot; kindref=&quot;compound&quot;&gt;db::SimpleTag&lt;/ref&gt;&lt;sp/&gt;{&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     174 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;using&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;type&lt;sp/&gt;=&lt;sp/&gt;double;&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     175 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;static&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;ref refid=&quot;cpp/string/basic_string&quot; kindref=&quot;compound&quot; external=&quot;/work/spectre/docs/config/cppreference-doxygen-web.tag.xml&quot;&gt;std::string&lt;/ref&gt;&lt;sp/&gt;name()&lt;sp/&gt;noexcept&lt;sp/&gt;{&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keywordflow&quot;&gt;return&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;stringliteral&quot;&gt;&amp;quot;Radius&amp;quot;&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;;&lt;sp/&gt;}&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     176 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;};&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     177 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;struct&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;Density&lt;sp/&gt;:&lt;sp/&gt;&lt;ref refid=&quot;structdb_1_1SimpleTag&quot; kindref=&quot;compound&quot;&gt;db::SimpleTag&lt;/ref&gt;&lt;sp/&gt;{&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     178 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;using&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;type&lt;sp/&gt;=&lt;sp/&gt;double;&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     179 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;static&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;ref refid=&quot;cpp/string/basic_string&quot; kindref=&quot;compound&quot; external=&quot;/work/spectre/docs/config/cppreference-doxygen-web.tag.xml&quot;&gt;std::string&lt;/ref&gt;&lt;sp/&gt;name()&lt;sp/&gt;noexcept&lt;sp/&gt;{&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keywordflow&quot;&gt;return&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;stringliteral&quot;&gt;&amp;quot;Density&amp;quot;&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;;&lt;sp/&gt;}&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     180 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;};&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     181 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;struct&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;ref refid=&quot;group__ObserversGroup_1gga9601b9f188609201444e989ee8825b45abd7a9717d29c5ddcab1bc175eda1e298&quot; kindref=&quot;member&quot;&gt;Volume&lt;/ref&gt;&lt;sp/&gt;:&lt;sp/&gt;&lt;ref refid=&quot;structdb_1_1SimpleTag&quot; kindref=&quot;compound&quot;&gt;db::SimpleTag&lt;/ref&gt;&lt;sp/&gt;{&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     182 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;using&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;type&lt;sp/&gt;=&lt;sp/&gt;double;&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     183 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;static&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;ref refid=&quot;cpp/string/basic_string&quot; kindref=&quot;compound&quot; external=&quot;/work/spectre/docs/config/cppreference-doxygen-web.tag.xml&quot;&gt;std::string&lt;/ref&gt;&lt;sp/&gt;name()&lt;sp/&gt;noexcept&lt;sp/&gt;{&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keywordflow&quot;&gt;return&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;stringliteral&quot;&gt;&amp;quot;Volume&amp;quot;&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;;&lt;sp/&gt;}&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     184 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;};&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     185 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;struct&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;Mass&lt;sp/&gt;:&lt;sp/&gt;&lt;ref refid=&quot;structdb_1_1SimpleTag&quot; kindref=&quot;compound&quot;&gt;db::SimpleTag&lt;/ref&gt;&lt;sp/&gt;{&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     186 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;using&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;type&lt;sp/&gt;=&lt;sp/&gt;double;&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     187 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;static&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;ref refid=&quot;cpp/string/basic_string&quot; kindref=&quot;compound&quot; external=&quot;/work/spectre/docs/config/cppreference-doxygen-web.tag.xml&quot;&gt;std::string&lt;/ref&gt;&lt;sp/&gt;name()&lt;sp/&gt;noexcept&lt;sp/&gt;{&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keywordflow&quot;&gt;return&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;stringliteral&quot;&gt;&amp;quot;Mass&amp;quot;&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;;&lt;sp/&gt;}&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     188 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;};&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     189 </span>            : &lt;/programlisting&gt; As seen above, SimpleTags have a &lt;computeroutput&gt;type&lt;/computeroutput&gt; and a &lt;computeroutput&gt;name&lt;/computeroutput&gt; in their struct. When creating tags for use with a DataBox, we must make sure to the tag inherits from one of the existing DataBox tag types such as &lt;computeroutput&gt;&lt;ref refid=&quot;structdb_1_1SimpleTag&quot; kindref=&quot;compound&quot;&gt;db::SimpleTag&lt;/ref&gt;&lt;/computeroutput&gt;. We now create our first DataBox using these &lt;computeroutput&gt;SimpleTags&lt;/computeroutput&gt;:&lt;/para&gt;&lt;para&gt;&lt;programlisting&gt;&lt;codeline&gt;&lt;highlight class=&quot;keyword&quot;&gt;const&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;auto&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;refined_databox&lt;sp/&gt;=&lt;sp/&gt;&lt;ref refid=&quot;group__DataBoxGroup_1ga190fd7a31cd2424701e03faea2d03247&quot; kindref=&quot;member&quot;&gt;db::create&lt;/ref&gt;&amp;lt;&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     190 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;ref refid=&quot;group__DataBoxGroup_1ga3dc674ba575ece4a8be1c23fa6c2cdcb&quot; kindref=&quot;member&quot;&gt;db::AddSimpleTags&lt;/ref&gt;&amp;lt;&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     191 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;Velocity,&lt;sp/&gt;Radius,&lt;sp/&gt;Density,&lt;sp/&gt;&lt;ref refid=&quot;group__ObserversGroup_1gga9601b9f188609201444e989ee8825b45abd7a9717d29c5ddcab1bc175eda1e298&quot; kindref=&quot;member&quot;&gt;Volume&lt;/ref&gt;&amp;gt;&amp;gt;(4.0,&lt;sp/&gt;2.0,&lt;sp/&gt;0.5,&lt;sp/&gt;10.0);&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     192 </span>            : &lt;/programlisting&gt; We can get our quantities out of the DataBox by using &lt;computeroutput&gt;&lt;ref refid=&quot;group__DataBoxGroup_1gae08744824ea7df89224f128b2080c5b1&quot; kindref=&quot;member&quot;&gt;db::get&lt;/ref&gt;&lt;/computeroutput&gt;:&lt;/para&gt;&lt;para&gt;&lt;programlisting&gt;&lt;codeline&gt;&lt;highlight class=&quot;keyword&quot;&gt;const&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keywordtype&quot;&gt;double&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;velocity&lt;sp/&gt;=&lt;sp/&gt;db::get&amp;lt;Velocity&amp;gt;(refined_databox);&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     193 </span>            : &lt;/programlisting&gt; So far, the usage of DataBox has been similar to the usage of TaggedTuple. To address the desire to combine the functionality of tags with the modularity of functions, DataBox provides ComputeTags.&lt;/para&gt;&lt;/sect2&gt;
<span class="lineNum">     194 </span>            : &lt;sect2 id=&quot;databox_foundations_1databox_documentation_for_compute_tags&quot;&gt;
<span class="lineNum">     195 </span>            : &lt;title&gt;ComputeTags&lt;/title&gt;
<span class="lineNum">     196 </span>            : &lt;para&gt;ComputeTags are used to tag functions that are used in conjunction with a DataBox to produce a new quantity. ComputeTags look like:&lt;/para&gt;&lt;para&gt;&lt;programlisting&gt;&lt;codeline&gt;&lt;highlight class=&quot;keyword&quot;&gt;struct&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;MassCompute&lt;sp/&gt;:&lt;sp/&gt;&lt;ref refid=&quot;structdb_1_1ComputeTag&quot; kindref=&quot;compound&quot;&gt;db::ComputeTag&lt;/ref&gt;,&lt;sp/&gt;Mass&lt;sp/&gt;{&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     197 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;static&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;ref refid=&quot;cpp/string/basic_string&quot; kindref=&quot;compound&quot; external=&quot;/work/spectre/docs/config/cppreference-doxygen-web.tag.xml&quot;&gt;std::string&lt;/ref&gt;&lt;sp/&gt;name()&lt;sp/&gt;noexcept&lt;sp/&gt;{&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keywordflow&quot;&gt;return&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;stringliteral&quot;&gt;&amp;quot;MassCompute&amp;quot;&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;;&lt;sp/&gt;}&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     198 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;static&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;constexpr&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;auto&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;function&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;=&lt;sp/&gt;&amp;amp;mass_from_density_and_volume;&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     199 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;using&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;argument_tags&lt;sp/&gt;=&lt;sp/&gt;tmpl::list&amp;lt;Density,&lt;sp/&gt;Volume&amp;gt;;&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     200 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;};&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     201 </span>            : &lt;/programlisting&gt; ComputeTags inherit from &lt;computeroutput&gt;&lt;ref refid=&quot;structdb_1_1ComputeTag&quot; kindref=&quot;compound&quot;&gt;db::ComputeTag&lt;/ref&gt;&lt;/computeroutput&gt;, and it is convenient to have them additionally inherit from an existing SimpleTag (in this case &lt;computeroutput&gt;Mass&lt;/computeroutput&gt;) so that the quantity &lt;computeroutput&gt;MassCompute&lt;/computeroutput&gt; can be obtained through the SimpleTag &lt;computeroutput&gt;Mass&lt;/computeroutput&gt;. We use the naming convention &lt;computeroutput&gt;TagNameCompute&lt;/computeroutput&gt; so that &lt;computeroutput&gt;TagNameCompute&lt;/computeroutput&gt; and &lt;computeroutput&gt;TagName&lt;/computeroutput&gt; appear next to each other in documentation that lists tags in alphabetical order.&lt;/para&gt;&lt;para&gt;We have also added the type alias &lt;computeroutput&gt;argument_tags&lt;/computeroutput&gt;, which is necessary in order to refer to the correct tagged quantities in the DataBox.&lt;/para&gt;&lt;para&gt;&lt;simplesect kind=&quot;note&quot;&gt;&lt;para&gt;The &lt;computeroutput&gt;tmpl::list&lt;/computeroutput&gt; used in the type alias is a contiguous container only holding types. That is, there is no variable runtime data associated with it like there is for &lt;computeroutput&gt;&lt;ref refid=&quot;cpp/utility/tuple&quot; kindref=&quot;compound&quot; external=&quot;/work/spectre/docs/config/cppreference-doxygen-web.tag.xml&quot;&gt;std::tuple&lt;/ref&gt;&lt;/computeroutput&gt;, which is a container associating types with values. &lt;computeroutput&gt;tmpl::list&lt;/computeroutput&gt;s are useful in situations when one is working with multiple tags at once.&lt;/para&gt;&lt;/simplesect&gt;
<span class="lineNum">     202 </span>            : Using nested type aliases to pass around information at compile time is a common pattern in SpECTRE. Let us see how we can compute our beloved quantity of mass times acceleration:&lt;/para&gt;&lt;para&gt;&lt;programlisting&gt;&lt;codeline&gt;&lt;highlight class=&quot;keyword&quot;&gt;struct&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;Force&lt;sp/&gt;:&lt;sp/&gt;&lt;ref refid=&quot;structdb_1_1SimpleTag&quot; kindref=&quot;compound&quot;&gt;db::SimpleTag&lt;/ref&gt;&lt;sp/&gt;{&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     203 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;using&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;type&lt;sp/&gt;=&lt;sp/&gt;double;&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     204 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;static&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;ref refid=&quot;cpp/string/basic_string&quot; kindref=&quot;compound&quot; external=&quot;/work/spectre/docs/config/cppreference-doxygen-web.tag.xml&quot;&gt;std::string&lt;/ref&gt;&lt;sp/&gt;name()&lt;sp/&gt;noexcept&lt;sp/&gt;{&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keywordflow&quot;&gt;return&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;stringliteral&quot;&gt;&amp;quot;Force&amp;quot;&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;;&lt;sp/&gt;}&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     205 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;};&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     206 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     207 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;struct&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;ForceCompute&lt;sp/&gt;:&lt;sp/&gt;&lt;ref refid=&quot;structdb_1_1ComputeTag&quot; kindref=&quot;compound&quot;&gt;db::ComputeTag&lt;/ref&gt;,&lt;sp/&gt;Force&lt;sp/&gt;{&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     208 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;static&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;ref refid=&quot;cpp/string/basic_string&quot; kindref=&quot;compound&quot; external=&quot;/work/spectre/docs/config/cppreference-doxygen-web.tag.xml&quot;&gt;std::string&lt;/ref&gt;&lt;sp/&gt;name()&lt;sp/&gt;noexcept&lt;sp/&gt;{&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keywordflow&quot;&gt;return&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;stringliteral&quot;&gt;&amp;quot;ForceCompute&amp;quot;&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;;&lt;sp/&gt;}&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     209 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;static&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;constexpr&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;auto&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;function&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;(&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     210 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;const&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keywordtype&quot;&gt;double&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&amp;amp;&lt;sp/&gt;mass,&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;const&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keywordtype&quot;&gt;double&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&amp;amp;&lt;sp/&gt;acceleration)&lt;sp/&gt;noexcept&lt;sp/&gt;{&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     211 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keywordflow&quot;&gt;return&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;mass&lt;sp/&gt;*&lt;sp/&gt;acceleration;&lt;sp/&gt;}&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     212 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;using&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;argument_tags&lt;sp/&gt;=&lt;sp/&gt;tmpl::list&amp;lt;Mass,&lt;sp/&gt;Acceleration&amp;gt;;&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     213 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;};&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     214 </span>            : &lt;/programlisting&gt; And that&amp;apos;s it! &lt;computeroutput&gt;&lt;ref refid=&quot;group__DataBoxGroup_1gae08744824ea7df89224f128b2080c5b1&quot; kindref=&quot;member&quot;&gt;db::get&lt;/ref&gt;&lt;/computeroutput&gt; utilizes the &lt;computeroutput&gt;argument_tags&lt;/computeroutput&gt; specified in &lt;computeroutput&gt;ForceCompute&lt;/computeroutput&gt; to determine which items to get out of the &lt;computeroutput&gt;refined_databox&lt;/computeroutput&gt;. With the corresponding quantities in hand, &lt;computeroutput&gt;&lt;ref refid=&quot;group__DataBoxGroup_1gae08744824ea7df89224f128b2080c5b1&quot; kindref=&quot;member&quot;&gt;db::get&lt;/ref&gt;&lt;/computeroutput&gt; passes them as arguments to the &lt;computeroutput&gt;function&lt;/computeroutput&gt; specified in &lt;computeroutput&gt;ForceCompute&lt;/computeroutput&gt;. This is why every &lt;computeroutput&gt;ComputeTag&lt;/computeroutput&gt; must have an &lt;computeroutput&gt;argument_tags&lt;/computeroutput&gt; as well as a &lt;computeroutput&gt;function&lt;/computeroutput&gt; specified; this is the contract with DataBox they must satisfy in order to enjoy the full benefits of DataBox&amp;apos;s generality.&lt;/para&gt;&lt;/sect2&gt;
<span class="lineNum">     215 </span>            : &lt;sect2 id=&quot;databox_foundations_1databox_documentation_for_mutate_tags&quot;&gt;
<span class="lineNum">     216 </span>            : &lt;title&gt;Mutating DataBox items&lt;/title&gt;
<span class="lineNum">     217 </span>            : &lt;para&gt;It is reasonable to expect that in a complicated calculation, we will encounter time-dependent or iteration-dependent variables. As a result, in addition to adding and retrieving items from our DataBox, we also need a way to &lt;emphasis&gt;mutate&lt;/emphasis&gt; quantities already present in the DataBox. This can be done via &lt;computeroutput&gt;&lt;ref refid=&quot;group__DataBoxGroup_1gac9900e6610ba0bce5834e8cb035d834d&quot; kindref=&quot;member&quot;&gt;db::mutate_apply&lt;/ref&gt;&lt;/computeroutput&gt; and can look like the following:&lt;/para&gt;&lt;para&gt;&lt;simplesect kind=&quot;note&quot;&gt;&lt;para&gt;There is an alternative to &lt;computeroutput&gt;&lt;ref refid=&quot;group__DataBoxGroup_1gac9900e6610ba0bce5834e8cb035d834d&quot; kindref=&quot;member&quot;&gt;db::mutate_apply&lt;/ref&gt;&lt;/computeroutput&gt;, &lt;computeroutput&gt;&lt;ref refid=&quot;group__DataBoxGroup_1ga7f507859b93a8bd60c6f9f05077ab2bc&quot; kindref=&quot;member&quot;&gt;db::mutate&lt;/ref&gt;&lt;/computeroutput&gt;. See the &lt;ref refid=&quot;group__DataBoxGroup&quot; kindref=&quot;compound&quot;&gt;DataBox documentation&lt;/ref&gt; for more details.&lt;/para&gt;&lt;/simplesect&gt;
<span class="lineNum">     218 </span>            : &lt;programlisting&gt;&lt;codeline&gt;&lt;highlight class=&quot;keyword&quot;&gt;struct&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;ref refid=&quot;classTime&quot; kindref=&quot;compound&quot;&gt;Time&lt;/ref&gt;&lt;sp/&gt;:&lt;sp/&gt;&lt;ref refid=&quot;structdb_1_1SimpleTag&quot; kindref=&quot;compound&quot;&gt;db::SimpleTag&lt;/ref&gt;&lt;sp/&gt;{&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     219 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;using&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;type&lt;sp/&gt;=&lt;sp/&gt;double;&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     220 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;static&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;ref refid=&quot;cpp/string/basic_string&quot; kindref=&quot;compound&quot; external=&quot;/work/spectre/docs/config/cppreference-doxygen-web.tag.xml&quot;&gt;std::string&lt;/ref&gt;&lt;sp/&gt;name()&lt;sp/&gt;noexcept&lt;sp/&gt;{&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keywordflow&quot;&gt;return&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;stringliteral&quot;&gt;&amp;quot;Time&amp;quot;&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;;&lt;sp/&gt;}&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     221 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;};&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     222 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     223 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;struct&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;TimeStep&lt;sp/&gt;:&lt;sp/&gt;&lt;ref refid=&quot;structdb_1_1SimpleTag&quot; kindref=&quot;compound&quot;&gt;db::SimpleTag&lt;/ref&gt;&lt;sp/&gt;{&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     224 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;using&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;type&lt;sp/&gt;=&lt;sp/&gt;double;&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     225 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;static&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;ref refid=&quot;cpp/string/basic_string&quot; kindref=&quot;compound&quot; external=&quot;/work/spectre/docs/config/cppreference-doxygen-web.tag.xml&quot;&gt;std::string&lt;/ref&gt;&lt;sp/&gt;name()&lt;sp/&gt;noexcept&lt;sp/&gt;{&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keywordflow&quot;&gt;return&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;stringliteral&quot;&gt;&amp;quot;TimeStep&amp;quot;&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;;&lt;sp/&gt;}&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     226 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;};&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     227 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     228 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;struct&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;EarthGravity&lt;sp/&gt;:&lt;sp/&gt;&lt;ref refid=&quot;structdb_1_1SimpleTag&quot; kindref=&quot;compound&quot;&gt;db::SimpleTag&lt;/ref&gt;&lt;sp/&gt;{&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     229 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;using&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;type&lt;sp/&gt;=&lt;sp/&gt;double;&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     230 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;static&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;ref refid=&quot;cpp/string/basic_string&quot; kindref=&quot;compound&quot; external=&quot;/work/spectre/docs/config/cppreference-doxygen-web.tag.xml&quot;&gt;std::string&lt;/ref&gt;&lt;sp/&gt;name()&lt;sp/&gt;noexcept&lt;sp/&gt;{&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keywordflow&quot;&gt;return&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;stringliteral&quot;&gt;&amp;quot;EarthGravity&amp;quot;&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;;&lt;sp/&gt;}&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     231 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;};&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     232 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     233 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;struct&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;FallingSpeed&lt;sp/&gt;:&lt;sp/&gt;&lt;ref refid=&quot;structdb_1_1SimpleTag&quot; kindref=&quot;compound&quot;&gt;db::SimpleTag&lt;/ref&gt;&lt;sp/&gt;{&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     234 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;using&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;type&lt;sp/&gt;=&lt;sp/&gt;double;&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     235 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;static&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;ref refid=&quot;cpp/string/basic_string&quot; kindref=&quot;compound&quot; external=&quot;/work/spectre/docs/config/cppreference-doxygen-web.tag.xml&quot;&gt;std::string&lt;/ref&gt;&lt;sp/&gt;name()&lt;sp/&gt;noexcept&lt;sp/&gt;{&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keywordflow&quot;&gt;return&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;stringliteral&quot;&gt;&amp;quot;FallingSpeed&amp;quot;&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;;&lt;sp/&gt;}&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     236 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;};&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     237 </span>            : &lt;/programlisting&gt;&lt;programlisting&gt;&lt;codeline&gt;&lt;highlight class=&quot;keyword&quot;&gt;auto&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;time_dependent_databox&lt;sp/&gt;=&lt;sp/&gt;&lt;ref refid=&quot;group__DataBoxGroup_1ga190fd7a31cd2424701e03faea2d03247&quot; kindref=&quot;member&quot;&gt;db::create&lt;/ref&gt;&amp;lt;&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     238 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;ref refid=&quot;group__DataBoxGroup_1ga3dc674ba575ece4a8be1c23fa6c2cdcb&quot; kindref=&quot;member&quot;&gt;db::AddSimpleTags&lt;/ref&gt;&amp;lt;&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     239 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;ref refid=&quot;classTime&quot; kindref=&quot;compound&quot;&gt;Time&lt;/ref&gt;,&lt;sp/&gt;TimeStep,&lt;sp/&gt;EarthGravity,&lt;sp/&gt;FallingSpeed&amp;gt;&amp;gt;(0.0,&lt;sp/&gt;0.1,&lt;sp/&gt;-9.8,&lt;sp/&gt;-10.0);&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     240 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;ref refid=&quot;group__DataBoxGroup_1gac9900e6610ba0bce5834e8cb035d834d&quot; kindref=&quot;member&quot;&gt;db::mutate_apply&lt;/ref&gt;&amp;lt;&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     241 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;comment&quot;&gt;//MutateTags&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     242 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;tmpl::list&amp;lt;Time,&lt;sp/&gt;FallingSpeed&amp;gt;,&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     243 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;comment&quot;&gt;//ArgumentTags&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     244 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;tmpl::list&amp;lt;TimeStep,&lt;sp/&gt;EarthGravity&amp;gt;&amp;gt;(&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     245 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;[](&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;const&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;ref refid=&quot;classgsl_1_1not__null&quot; kindref=&quot;compound&quot;&gt;gsl::not_null&amp;lt;double*&amp;gt;&lt;/ref&gt;&lt;sp/&gt;&lt;ref refid=&quot;cpp/chrono/c/time&quot; kindref=&quot;compound&quot; external=&quot;/work/spectre/docs/config/cppreference-doxygen-web.tag.xml&quot;&gt;time&lt;/ref&gt;,&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     246 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;const&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;ref refid=&quot;classgsl_1_1not__null&quot; kindref=&quot;compound&quot;&gt;gsl::not_null&amp;lt;double*&amp;gt;&lt;/ref&gt;&lt;sp/&gt;falling_speed,&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     247 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;const&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keywordtype&quot;&gt;double&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&amp;amp;&lt;sp/&gt;time_step,&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     248 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;const&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keywordtype&quot;&gt;double&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&amp;amp;&lt;sp/&gt;earth_gravity)&lt;sp/&gt;{&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     249 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;*time&lt;sp/&gt;+=&lt;sp/&gt;time_step;&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     250 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;*falling_speed&lt;sp/&gt;+=&lt;sp/&gt;time_step&lt;sp/&gt;*&lt;sp/&gt;earth_gravity;&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     251 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;},&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     252 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;ref refid=&quot;Gsl_8hpp_1a649c6961f9146205c203e45d58fd0c4c&quot; kindref=&quot;member&quot;&gt;make_not_null&lt;/ref&gt;(&amp;amp;time_dependent_databox));&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     253 </span>            : &lt;/programlisting&gt; &lt;simplesect kind=&quot;note&quot;&gt;&lt;para&gt;The &lt;computeroutput&gt;not_null&lt;/computeroutput&gt;s here are used to give us the assurance that the pointers &lt;computeroutput&gt;time&lt;/computeroutput&gt; and &lt;computeroutput&gt;falling_speed&lt;/computeroutput&gt; are not null pointers. Using raw pointers alone, we risk running into segmentation faults if we dereference null pointers. With &lt;computeroutput&gt;not_null&lt;/computeroutput&gt;s we instead run into a run time error that tells us what went wrong. For information on the usage of &lt;computeroutput&gt;not_null&lt;/computeroutput&gt;, see the documentation for &lt;ref refid=&quot;Gsl_8hpp&quot; kindref=&quot;compound&quot;&gt;Gsl.hpp&lt;/ref&gt;.&lt;/para&gt;&lt;/simplesect&gt;
<span class="lineNum">     254 </span>            : In the above &lt;computeroutput&gt;&lt;ref refid=&quot;group__DataBoxGroup_1gac9900e6610ba0bce5834e8cb035d834d&quot; kindref=&quot;member&quot;&gt;db::mutate_apply&lt;/ref&gt;&lt;/computeroutput&gt; example, we are changing two values in the DataBox using four values from the DataBox. The mutated quantities must be passed in as &lt;computeroutput&gt;&lt;ref refid=&quot;classgsl_1_1not__null&quot; kindref=&quot;compound&quot;&gt;gsl::not_null&lt;/ref&gt;&lt;/computeroutput&gt;s to the lambda. The non-mutated quantities are passed in as const references to the lambda.&lt;/para&gt;&lt;para&gt;&lt;simplesect kind=&quot;note&quot;&gt;&lt;para&gt;It is critical to guarantee that there is a strict demarcation between pre-&lt;computeroutput&gt;&lt;ref refid=&quot;group__DataBoxGroup_1ga7f507859b93a8bd60c6f9f05077ab2bc&quot; kindref=&quot;member&quot;&gt;db::mutate&lt;/ref&gt;&lt;/computeroutput&gt; and post-&lt;computeroutput&gt;&lt;ref refid=&quot;group__DataBoxGroup_1ga7f507859b93a8bd60c6f9f05077ab2bc&quot; kindref=&quot;member&quot;&gt;db::mutate&lt;/ref&gt;&lt;/computeroutput&gt; quantities. &lt;computeroutput&gt;&lt;ref refid=&quot;group__DataBoxGroup_1ga7f507859b93a8bd60c6f9f05077ab2bc&quot; kindref=&quot;member&quot;&gt;db::mutate&lt;/ref&gt;&lt;/computeroutput&gt; provides this guarantee via a locking mechanism; within one mutate call, all initial pre-mutated quantities are obtained from the DataBox before performing a single mutation.&lt;/para&gt;&lt;/simplesect&gt;
<span class="lineNum">     255 </span>            : &lt;simplesect kind=&quot;note&quot;&gt;&lt;para&gt;The mutate functions described above are the only accepted ways to edit data in the Databox. It is technically possible to use pointers or references to edit data stored in the Databox, but this bypasses the compute tags architecture. All changes to the Databox must be made by the Databox itself via mutate functions.&lt;/para&gt;&lt;/simplesect&gt;
<span class="lineNum">     256 </span>            : From the above, we can see that the different kinds of tags are provided in two different &lt;computeroutput&gt;tmpl::list&lt;/computeroutput&gt;s. The &lt;computeroutput&gt;MutateTags&lt;/computeroutput&gt;, also called &lt;computeroutput&gt;ReturnTags&lt;/computeroutput&gt;, refer to the quantities in the DataBox we wish to mutate, and the &lt;computeroutput&gt;ArgumentTags&lt;/computeroutput&gt; refer to additional quantities we need from the DataBox to complete our computation. We now return to the recurring question of how to make this construction more modular.&lt;/para&gt;&lt;para&gt;We have now worked our way up to SpECTRE&amp;apos;s DataBox, but as we can see in the above &lt;computeroutput&gt;&lt;ref refid=&quot;group__DataBoxGroup_1gac9900e6610ba0bce5834e8cb035d834d&quot; kindref=&quot;member&quot;&gt;db::mutate_apply&lt;/ref&gt;&lt;/computeroutput&gt; example, the lambda used to perform the mutation ends up being independent of any tags or template parameters! This means we can factor it out and place it in its own module, where it can be tested independently of the DataBox.&lt;/para&gt;&lt;/sect2&gt;
<span class="lineNum">     257 </span>            : &lt;/sect1&gt;
<span class="lineNum">     258 </span>            : &lt;sect1 id=&quot;databox_foundations_1databox_towards_actions&quot;&gt;
<span class="lineNum">     259 </span>            : &lt;title&gt;Toward SpECTRE&amp;apos;s Actions&lt;/title&gt;
<span class="lineNum">     260 </span>            : &lt;sect2 id=&quot;databox_foundations_1databox_documentation_for_mutators&quot;&gt;
<span class="lineNum">     261 </span>            : &lt;title&gt;Mutators&lt;/title&gt;
<span class="lineNum">     262 </span>            : &lt;para&gt;These constructs that exist independently of the DataBox are the precursors to SpECTRE&amp;apos;s &lt;emphasis&gt;Actions&lt;/emphasis&gt;. As they are designed to be used with &lt;computeroutput&gt;&lt;ref refid=&quot;group__DataBoxGroup_1ga7f507859b93a8bd60c6f9f05077ab2bc&quot; kindref=&quot;member&quot;&gt;db::mutate&lt;/ref&gt;&lt;/computeroutput&gt; and &lt;computeroutput&gt;&lt;ref refid=&quot;group__DataBoxGroup_1gac9900e6610ba0bce5834e8cb035d834d&quot; kindref=&quot;member&quot;&gt;db::mutate_apply&lt;/ref&gt;&lt;/computeroutput&gt;, we give them the name &lt;emphasis&gt;Mutators&lt;/emphasis&gt;. Here is the above lambda written as a Mutator-prototype, a struct-with-void-apply:&lt;/para&gt;&lt;para&gt;&lt;programlisting&gt;&lt;codeline&gt;&lt;highlight class=&quot;keyword&quot;&gt;struct&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;IntendedMutation&lt;sp/&gt;{&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     263 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;static&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keywordtype&quot;&gt;void&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;ref refid=&quot;group__DataBoxGroup_1ga397a72505e7853079243a68ab36bf85b&quot; kindref=&quot;member&quot;&gt;apply&lt;/ref&gt;(&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;const&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;ref refid=&quot;classgsl_1_1not__null&quot; kindref=&quot;compound&quot;&gt;gsl::not_null&amp;lt;double*&amp;gt;&lt;/ref&gt;&lt;sp/&gt;time,&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     264 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;const&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;ref refid=&quot;classgsl_1_1not__null&quot; kindref=&quot;compound&quot;&gt;gsl::not_null&amp;lt;double*&amp;gt;&lt;/ref&gt;&lt;sp/&gt;falling_speed,&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     265 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;const&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keywordtype&quot;&gt;double&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;time_step,&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     266 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;const&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keywordtype&quot;&gt;double&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;earth_gravity)&lt;sp/&gt;{&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     267 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;*time&lt;sp/&gt;+=&lt;sp/&gt;time_step;&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     268 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;*falling_speed&lt;sp/&gt;+=&lt;sp/&gt;time_step&lt;sp/&gt;*&lt;sp/&gt;earth_gravity;&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     269 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;}&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     270 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;};&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     271 </span>            : &lt;/programlisting&gt; The call to &lt;computeroutput&gt;&lt;ref refid=&quot;group__DataBoxGroup_1gac9900e6610ba0bce5834e8cb035d834d&quot; kindref=&quot;member&quot;&gt;db::mutate_apply&lt;/ref&gt;&lt;/computeroutput&gt; has now been made much simpler:&lt;/para&gt;&lt;para&gt;&lt;programlisting&gt;&lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;ref refid=&quot;group__DataBoxGroup_1gac9900e6610ba0bce5834e8cb035d834d&quot; kindref=&quot;member&quot;&gt;db::mutate_apply&lt;/ref&gt;&amp;lt;&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     272 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;tmpl::list&amp;lt;Time,&lt;sp/&gt;FallingSpeed&amp;gt;,&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     273 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;tmpl::list&amp;lt;TimeStep,&lt;sp/&gt;EarthGravity&amp;gt;&amp;gt;(&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     274 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;IntendedMutation{},&lt;sp/&gt;&lt;ref refid=&quot;Gsl_8hpp_1a649c6961f9146205c203e45d58fd0c4c&quot; kindref=&quot;member&quot;&gt;make_not_null&lt;/ref&gt;(&amp;amp;time_dependent_databox));&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     275 </span>            : &lt;/programlisting&gt; There is a key step that we take here after this point, to make our struct-with-void-apply into a proper Mutator. As we will see, this addition will allow us to entirely divorce the internal details of &lt;computeroutput&gt;IntendedMutation&lt;/computeroutput&gt; from the mechanism through which we update the DataBox. The key step is to add type aliases to &lt;computeroutput&gt;IntendedMutation&lt;/computeroutput&gt;:&lt;/para&gt;&lt;para&gt;&lt;programlisting&gt;&lt;codeline&gt;&lt;highlight class=&quot;keyword&quot;&gt;struct&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;IntendedMutation2&lt;sp/&gt;{&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     276 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;using&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;return_tags&lt;sp/&gt;=&lt;sp/&gt;tmpl::list&amp;lt;Time,&lt;sp/&gt;FallingSpeed&amp;gt;;&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     277 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;using&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;argument_tags&lt;sp/&gt;=&lt;sp/&gt;tmpl::list&amp;lt;TimeStep,&lt;sp/&gt;EarthGravity&amp;gt;;&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     278 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     279 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;static&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keywordtype&quot;&gt;void&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;ref refid=&quot;group__DataBoxGroup_1ga397a72505e7853079243a68ab36bf85b&quot; kindref=&quot;member&quot;&gt;apply&lt;/ref&gt;(&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;const&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;ref refid=&quot;classgsl_1_1not__null&quot; kindref=&quot;compound&quot;&gt;gsl::not_null&amp;lt;double*&amp;gt;&lt;/ref&gt;&lt;sp/&gt;time,&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     280 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;const&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;ref refid=&quot;classgsl_1_1not__null&quot; kindref=&quot;compound&quot;&gt;gsl::not_null&amp;lt;double*&amp;gt;&lt;/ref&gt;&lt;sp/&gt;falling_speed,&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     281 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;const&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keywordtype&quot;&gt;double&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;time_step,&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     282 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;const&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keywordtype&quot;&gt;double&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;earth_gravity)&lt;sp/&gt;{&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     283 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;*time&lt;sp/&gt;+=&lt;sp/&gt;time_step;&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     284 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;*falling_speed&lt;sp/&gt;+=&lt;sp/&gt;time_step&lt;sp/&gt;*&lt;sp/&gt;earth_gravity;&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     285 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;}&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     286 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;};&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     287 </span>            : &lt;/programlisting&gt; We are now able to write our call to &lt;computeroutput&gt;&lt;ref refid=&quot;group__DataBoxGroup_1gac9900e6610ba0bce5834e8cb035d834d&quot; kindref=&quot;member&quot;&gt;db::mutate_apply&lt;/ref&gt;&lt;/computeroutput&gt; in the following way:&lt;/para&gt;&lt;para&gt;&lt;programlisting&gt;&lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;db::mutate_apply&amp;lt;IntendedMutation2&amp;gt;(&lt;ref refid=&quot;Gsl_8hpp_1a649c6961f9146205c203e45d58fd0c4c&quot; kindref=&quot;member&quot;&gt;make_not_null&lt;/ref&gt;(&amp;amp;time_dependent_databox));&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     288 </span>            : &lt;/programlisting&gt; As we saw earlier with &lt;computeroutput&gt;QuantityCompute&lt;/computeroutput&gt;, we found that we were able to imbue structs with the ability to &amp;quot;read in&amp;quot; types specified in other structs, through the use of templates and member type aliases. This liberated us from having to hard-code in specific types. We notice immediately that &lt;computeroutput&gt;IntendedMutation&lt;/computeroutput&gt; is a hard-coded type that we can factor out in favor of a template parameter:&lt;/para&gt;&lt;para&gt;&lt;programlisting&gt;&lt;codeline&gt;&lt;highlight class=&quot;keyword&quot;&gt;template&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&amp;lt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;typename&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;Mutator&amp;gt;&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     289 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;struct&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;MyFirstAction{&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     290 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;template&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&amp;lt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;typename&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;DbTagsList&amp;gt;&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     291 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;static&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keywordtype&quot;&gt;void&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;ref refid=&quot;group__DataBoxGroup_1ga397a72505e7853079243a68ab36bf85b&quot; kindref=&quot;member&quot;&gt;apply&lt;/ref&gt;(&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     292 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;/highlight&gt;&lt;highlight class=&quot;keyword&quot;&gt;const&lt;/highlight&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;ref refid=&quot;classgsl_1_1not__null&quot; kindref=&quot;compound&quot;&gt;gsl::not_null&lt;/ref&gt;&amp;lt;&lt;ref refid=&quot;classdb_1_1DataBox&quot; kindref=&quot;compound&quot;&gt;db::DataBox&amp;lt;DbTagsList&amp;gt;&lt;/ref&gt;*&amp;gt;&lt;sp/&gt;time_dependent_databox)&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     293 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;noexcept&lt;sp/&gt;{&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     294 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;&lt;sp/&gt;db::mutate_apply&amp;lt;Mutator&amp;gt;(time_dependent_databox);&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     295 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;sp/&gt;&lt;sp/&gt;}&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     296 </span>            : &lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;};&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     297 </span>            : &lt;/programlisting&gt; Note how the &lt;computeroutput&gt;return_tags&lt;/computeroutput&gt; and &lt;computeroutput&gt;argument_tags&lt;/computeroutput&gt; are used as metavariables and are resolved by the compiler. Our call to &lt;computeroutput&gt;&lt;ref refid=&quot;group__DataBoxGroup_1gac9900e6610ba0bce5834e8cb035d834d&quot; kindref=&quot;member&quot;&gt;db::mutate_apply&lt;/ref&gt;&lt;/computeroutput&gt; has been fully wrapped and now takes the form:&lt;/para&gt;&lt;para&gt;&lt;programlisting&gt;&lt;codeline&gt;&lt;highlight class=&quot;normal&quot;&gt;&lt;ref refid=&quot;group__DataBoxGroup_1ga397a72505e7853079243a68ab36bf85b&quot; kindref=&quot;member&quot;&gt;MyFirstAction&amp;lt;IntendedMutation2&amp;gt;::apply&lt;/ref&gt;(&lt;ref refid=&quot;Gsl_8hpp_1a649c6961f9146205c203e45d58fd0c4c&quot; kindref=&quot;member&quot;&gt;make_not_null&lt;/ref&gt;(&amp;amp;time_dependent_databox));&lt;/highlight&gt;&lt;/codeline&gt;
<span class="lineNum">     298 </span>            : &lt;/programlisting&gt; The details of applying Mutators to the DataBox are entirely handled by &lt;computeroutput&gt;MyFirstAction&lt;/computeroutput&gt;, with the details of the specific Mutator itself entirely encapsulated in &lt;computeroutput&gt;IntendedMutation&lt;/computeroutput&gt;.&lt;/para&gt;&lt;para&gt;SpECTRE algorithms are decomposed into Actions which can depend on more things than we have considered here. Feel free to look at the existing &lt;ref refid=&quot;group__ActionsGroup&quot; kindref=&quot;compound&quot;&gt;actions that have been written.&lt;/ref&gt; The intricacies of Actions at the level that SpECTRE uses them is the subject of a future addition to the &lt;ref refid=&quot;dev_guide&quot; kindref=&quot;compound&quot;&gt;Developer&amp;apos;s Guide.&lt;/ref&gt; &lt;/para&gt;&lt;/sect2&gt;
<span class="lineNum">     299 </span>            : &lt;/sect1&gt;
<span class="lineNum">     300 </span>            :     &lt;/detaileddescription&gt;
<span class="lineNum">     301 </span>            :   &lt;/compounddef&gt;
<span class="lineNum">     302 </span>            : &lt;/doxygen&gt;
</pre>
      </td>
    </tr>
  </table>
  <br>

  <table width="100%" border=0 cellspacing=0 cellpadding=0>
    <tr><td class="ruler"><img src="../../../../glass.png" width=3 height=3 alt=""></td></tr>
    <tr><td class="versionInfo">Generated by: <a href="http://ltp.sourceforge.net/coverage/lcov.php" target="_parent">LCOV version 1.13</a></td></tr>
  </table>
  <br>

</body>
</html>
